<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="NordSym bygger intelligenta system som bygger sig själva. Från enskilda agenter till skräddarsydda ekosystem för er framgång.">
    <meta name="keywords" content="Systemautomation Sverige, intelligenta system, processautomation, skräddarsydda system, digital transformation, NordSym">
    <meta name="author" content="NordSym AB">
    <link rel="canonical" href="https://nordsym.com">
    <title>NordSym AB - System som växer med framtiden</title>
    
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="NordSym AB">
    <meta property="og:locale" content="sv_SE">
    <meta property="og:title" content="NordSym AB - System som växer med framtiden">
    <meta property="og:description" content="Vi bygger system som bygger sig själva. Från kaos till klarhet.">
    <meta property="og:image" content="https://raw.githubusercontent.com/GusHem/Logga-utan-text/refs/heads/main/Final%20logo%20no%20text.svg">
    <meta property="og:url" content="https://nordsym.com">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@NordSym">
    <meta name="twitter:creator" content="@NordSym">
    <meta name="twitter:title" content="NordSym AB - System som växer med framtiden">
    
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KRLNF7DHVJ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-KRLNF7DHVJ', { page_title: document.title, page_location: window.location.href });
    </script>
    
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "s6ismr0411");
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Post-processing for Glow Effect (Optional Enhancement) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/examples/js/postprocessing/EffectComposer.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/examples/js/postprocessing/RenderPass.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/examples/js/postprocessing/UnrealBloomPass.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/examples/js/shaders/LuminosityHighPassShader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/examples/js/shaders/CopyShader.js"></script>


    <link rel="preconnect" href="https://www.google-analytics.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//formspree.io">
    <link rel="preload" href="https://raw.githubusercontent.com/GusHem/Logga-utan-text/refs/heads/main/Final%20logo%20no%20text.svg" as="image">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&display=swap" as="style">
    <link rel="preload" href="https://unpkg.com/@phosphor-icons/web" as="script">

    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&family=Inter:wght@300;400;500;600;700;800&family=Source+Code+Pro:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link rel="icon" href="https://raw.githubusercontent.com/GusHem/Logga-utan-text/refs/heads/main/Final%20logo%20no%20text.svg">
    <style>
        html, body {
            height: 100%; margin: 0; padding: 0;
            scroll-behavior: smooth; overflow-x: hidden; 
        }
        body {
            font-family: 'Inter', sans-serif; color: #E2E8F0; 
            padding-top: 80px; display: flex; flex-direction: column;
            background-color: #0c1427;
            min-height: 100vh;
        }
        body.labb-active { 
            overflow: hidden;
        }
        @media (min-width: 1024px) { 
            body { padding-top: 116px; } 
        }
        main { flex-grow: 1; background: transparent; }
        :root {
            --nord-sym-cyan: #00D4FF;
            --nord-sym-orange: #FF8C00;
            --nord-sym-purple: #9370DB;
            --nord-sym-deep-space-blue: #0c1427; 
            --nord-sym-mid-space-blue: #1e3a8a; 
            --nord-sym-light-accent: #7dd3fc; 
            --nord-sym-text-light: #F0F4F8; 
            --nord-sym-text-medium: #CBD5E0; 
            --nord-sym-cyan-rgb: 0, 212, 255;
            --nord-sym-light-accent-rgb: 125, 211, 252;
        }
        .nord-accent-text { color: var(--nord-sym-cyan); }
        h1, h2, .section-title { font-family: 'Comfortaa', sans-serif; }
        .page-content-padding { padding-top: 4rem; padding-bottom: 4rem; }
        .space-background-section {
            background: transparent !important;
            position: relative; overflow: hidden; width: 100%; 
            display: flex; flex-direction: column; align-items: center;
        }
        #hero {
             min-height: calc(100vh - 80px); min-height: -webkit-fill-available;
             justify-content: center; padding-top: 4rem; padding-bottom: 4rem;
             position: relative; /* For canvas positioning */
        }
        @media (min-width: 1024px) { #hero { min-height: calc(100vh - 116px); } }
        #karriar .section-content-wrapper { max-width: 800px; }
        #karriar .intro-text, #karriar .detail-text { font-size: 1.125rem; line-height: 1.7; }
        @media (min-width: 1024px) {
            #karriar .section-title { font-size: 3.75rem; }
            #karriar .intro-text, #karriar .detail-text { font-size: 1.25rem; }
        }
        .section-content-wrapper { 
            position: relative; z-index: 1; width: 100%; max-width: 1280px; 
            padding-left: 1.5rem; padding-right: 1.5rem; margin-left: auto; margin-right: auto;
        }
        .nav-link.active { color: var(--nord-sym-cyan); font-weight: 700; } 
        .btn-base {
            font-weight: 600; border-radius: 9999px; transition: all 0.3s ease;
            box-shadow: 0px 6px 12px rgba(0, 0, 0, 0.25), 0px 2px 4px rgba(0,0,0,0.2), 
                        inset 0px -2px 1px rgba(255,255,255,0.05), inset 0px 1px 1px rgba(0,0,0,0.1); 
            display: inline-flex; align-items: center; justify-content: center;
            gap: 0.5rem; text-align: center;
        }
        .btn-cta-revised {
            padding: 0.85rem 2.25rem;
            background: rgba(0, 31, 63, 0.8);
            border: 2px solid var(--nord-sym-cyan);
            color: var(--nord-sym-cyan);
            backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
            font-weight: 600;
        }
        .btn-cta-revised:hover {
            background: rgba(var(--nord-sym-cyan-rgb), 0.1);
            box-shadow: 0 0 25px rgba(var(--nord-sym-cyan-rgb), 0.5);
            transform: translateY(-3px) scale(1.03);
        }
        .btn-secondary-on-dark {
            padding: 0.85rem 2.25rem; color: var(--nord-sym-text-light);
            border: 2px solid var(--nord-sym-text-light);
        }
        .btn-secondary-on-dark:hover {
            background-color: var(--nord-sym-text-light); color: var(--nord-sym-deep-space-blue);
            transform: translateY(-3px) scale(1.03);
             box-shadow: 0px 10px 20px rgba(240, 244, 248, 0.25), 0px 5px 10px rgba(0,0,0,0.2),
                        inset 0px -2px 2px rgba(255,255,255,0.03);
        }
        .btn-service-cta { 
            padding: 0.6rem 1.5rem; font-size: 0.875rem; background-color: transparent;
            color: var(--nord-sym-cyan); border: 2px solid var(--nord-sym-cyan);
        }
        .btn-service-cta:hover {
            background-color: var(--nord-sym-cyan); color: var(--nord-sym-deep-space-blue);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0px 8px 18px rgba(var(--nord-sym-cyan-rgb), 0.35), 0px 4px 7px rgba(0,0,0,0.2),
                        inset 0px -1px 2px rgba(255,255,255,0.08);
        }
        @media (max-width: 768px) {
            .btn-cta-revised, .btn-secondary-on-dark { min-height: 48px; font-size: 1rem; }
        }
        /* --- FORM TRANSFORMATION STYLES --- */
        .form-container {
            position: relative;
            overflow: hidden;
        }
        .form-input, .form-textarea, .form-select { 
            border: 1px solid #4A5568; background-color: rgba(26, 32, 44, 0.7); 
            color: var(--nord-sym-text-light); border-radius: 0.5rem; 
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            padding: 0.75rem 1rem; width: 100%;
        }
        .form-input::placeholder, .form-textarea::placeholder { color: #A0AEC0; }
        .form-input:focus, .form-textarea:focus, .form-select:focus {
            border-color: var(--nord-sym-cyan); background-color: rgba(26, 32, 44, 0.9);
            box-shadow: 0 0 0 3px rgba(var(--nord-sym-cyan-rgb), 0.4), 0 0 15px rgba(var(--nord-sym-cyan-rgb), 0.3); 
            outline: none;
        }
        .form-label {
            display: block; text-align: left; font-size: 0.875rem; 
            font-weight: 500; color: var(--nord-sym-text-medium); margin-bottom: 0.25rem; 
        }
        .form-step { display: none; }
        .form-step.active { display: block; }
        .form-progress-bar {
            height: 4px; background-color: rgba(var(--nord-sym-cyan-rgb), 0.2);
            border-radius: 2px; margin-bottom: 1.5rem; overflow: hidden;
        }
        .form-progress-bar-inner {
            height: 100%; width: 0%; background-color: var(--nord-sym-cyan);
            transition: width 0.5s ease-in-out;
        }
        .form-navigation {
            display: flex; justify-content: space-between; margin-top: 1.5rem;
        }
        .form-message {
            text-align: center; padding: 1rem;
            border-radius: 0.5rem;
        }
        .form-success-container {
            text-align: center;
        }
        .form-success-container .nordsym-logo-star {
            font-size: 4rem; margin-bottom: 1rem;
        }
        .form-success-container p {
            color: var(--nord-sym-text-light); font-size: 1.125rem;
        }
        .form-error-message {
            color: #F56565; border: 1px solid #F56565;
            background-color: rgba(245, 101, 101, 0.1);
        }
        .form-loading { position: relative; pointer-events: none; opacity: 0.7; }
        .form-loading::after {
            content: ''; position: absolute; top: 50%; left: 50%;
            width: 24px; height: 24px; border: 3px solid transparent;
            border-top-color: var(--nord-sym-cyan); border-radius: 50%;
            animation: spin 1s linear infinite; transform: translate(-50%, -50%);
        }
        @keyframes spin { 100% { transform: translate(-50%, -50%) rotate(360deg); } }
        /* --- END FORM TRANSFORMATION STYLES --- */
        main > section { display: none; }
        .card-base {
            border-radius: 1rem; transition: all 0.3s ease;
        }
        .card-base:hover { transform: translateY(-8px); }
        .content-card-dark { 
            background-color: rgba(12, 20, 39, 0.75); backdrop-filter: blur(8px); 
            color: var(--nord-sym-text-light); border: 1px solid rgba(var(--nord-sym-cyan-rgb), 0.25); 
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.3), 0px 5px 15px rgba(0,0,0,0.2); 
            padding: 2rem; display: flex; flex-direction: column;
        }
        .content-card-transparent, .cta-card-transparent { 
            background-color: rgba(12, 20, 39, 0.55); backdrop-filter: blur(12px); 
            color: var(--nord-sym-text-light); border: 1px solid rgba(var(--nord-sym-cyan-rgb), 0.35); 
            box-shadow: 0 8px 25px -8px rgba(0,0,0,0.4), 0px 4px 12px rgba(0,0,0,0.3); 
        }
        .content-card-dark:hover, .content-card-transparent:hover, .cta-card-transparent:hover {
            box-shadow: 0 25px 45px -12px rgba(0, 0, 0, 0.3), 0px 8px 20px rgba(0,0,0,0.25);
        }
        #header {
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            background-color: rgba(12, 20, 39, 0);
            backdrop-filter: none;
            z-index: 1000 !important;
        }
        body.labb-active #header {
            background: rgba(12, 20, 39, 0.3);
            backdrop-filter: blur(20px);
        }
        #header.scrolled { 
            background-color: rgba(12, 20, 39, 0.85); 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        #header .nav-link { color: var(--nord-sym-text-light); }
        #header .nav-link:hover { color: var(--nord-sym-cyan); }
        #header .nav-link.active { color: var(--nord-sym-cyan); font-weight: 700;}
        #mobile-menu { 
            z-index: 40;
            transform: translateX(-100%);
            transition: transform 0.4s cubic-bezier(0.22, 1, 0.36, 1);
        }
        #mobile-menu.open {
            transform: translateX(0);
        }
        #mobile-menu-trigger.active img { transform: rotate(45deg); }
        #hero-logo-wrapper {
            width: 100%; max-width: 300px; cursor: pointer;
            transition: transform 0.4s ease, filter 0.5s ease;
            filter: drop-shadow(0 0 8px rgba(var(--nord-sym-cyan-rgb), 0.2));
            position: relative; z-index: 10;
        }
        #hero-logo-wrapper:hover {
             transform: scale(1.05);
             filter: drop-shadow(0 0 25px rgba(var(--nord-sym-cyan-rgb), 0.6)) 
                    drop-shadow(0 0 10px rgba(var(--nord-sym-cyan-rgb), 0.4));
        }
        #hero-logo-wrapper img { width: 100%; height: auto; }
        @media (min-width: 1024px) { #hero-logo-wrapper { max-width: 400px; } }
        .pricing-card {
            background-color: rgba(var(--nord-sym-deep-space-blue), 0.8);
            border: 1px solid rgba(var(--nord-sym-cyan-rgb), 0.2);
            padding: 2.5rem; display: flex; flex-direction: column;
        }
        .pricing-card:hover {
            box-shadow: 0 15px 35px rgba(var(--nord-sym-cyan-rgb), 0.2);
            border-color: var(--nord-sym-cyan);
        }
        .pricing-card.ignite-package {
            border-color: var(--nord-sym-light-accent);
            box-shadow: 0 0 25px rgba(var(--nord-sym-light-accent-rgb), 0.3);
            transform: scale(1.05);
        }
        .pricing-card-header h3 {
            font-family: 'Comfortaa', sans-serif; font-size: 1.75rem;
            color: var(--nord-sym-text-light); margin-bottom: 0.5rem;
        }
        .pricing-card .price-display {
            font-size: 2.5rem; font-weight: 700;
            color: var(--nord-sym-cyan); margin: 1.5rem 0;
        }
        .pricing-card .price-display .price-period {
            font-size: 1rem; font-weight: 400; color: var(--nord-sym-text-medium);
        }
        .pricing-card ul { list-style-type: none; padding: 0; margin-bottom: 2rem; flex-grow: 1; }
        .pricing-card ul li {
            display: flex; align-items: flex-start; gap: 0.75rem;
            margin-bottom: 0.75rem; color: var(--nord-sym-text-medium);
        }
        .pricing-card ul li i { color: var(--nord-sym-cyan); margin-top: 0.2rem; flex-shrink: 0; }
        .venn-diagram-container {
            position: relative; display: flex; justify-content: center;
            align-items: center; padding: 2rem 0; width: 100%;
        }
        .venn-diagram-wrapper { position: relative; display: flex; flex-direction: column; align-items: center; }
        .venn-circle {
            width: 220px; height: 220px; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            text-align: center; box-sizing: border-box; font-weight: 600;
            color: var(--nord-sym-text-light); background-color: transparent;
            border: 1px solid var(--nord-sym-text-light);
            box-shadow: 0 0 25px rgba(0,0,0,0.4);
            position: relative; z-index: 1; transition: filter 0.3s ease;
        }
        .venn-circle:hover { filter: brightness(1.1); }
        .venn-circle-1 { z-index: 2; }
        .venn-circle-2 { margin-top: -80px; }
        .venn-circle-text { width: 80%; font-size: 0.9rem; line-height: 1.5; }
        .venn-overlap-text {
            font-weight: 700; color: var(--nord-sym-text-light); text-transform: uppercase;
            letter-spacing: 0.1em; font-size: 1rem; cursor: pointer; z-index: 3;
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            transition: text-shadow 0.3s ease, color 0.3s ease;
        }
        .venn-overlap-text:hover { color: var(--nord-sym-cyan); text-shadow: 0 0 10px var(--nord-sym-cyan); }
        @media (min-width: 768px) {
            .venn-diagram-wrapper { flex-direction: row; width: 460px; height: 300px; }
            .venn-circle { width: 280px; height: 280px; position: absolute; top: 50%; transform: translateY(-50%); }
            .venn-circle-1 { left: 0; margin-top: 0; }
            .venn-circle-2 { right: 0; margin-top: 0; }
            .venn-circle-text { position: absolute; top: 50%; transform: translateY(-50%); width: 50%; font-size: 1rem; }
            .venn-circle-1 .venn-circle-text { left: 1.5rem; text-align: left; }
            .venn-circle-2 .venn-circle-text { right: 1.5rem; text-align: right; }
            .venn-overlap-text { font-size: 1.25rem; letter-spacing: 0.05em; }
        }
        #atom-gallery-section { padding-top: 5rem; padding-bottom: 5rem; }
        .gallery-container {
            position: relative; max-width: 90%; margin: 0 auto;
            padding-top: 1rem; /* Space for hover effect */
        }
         @media (min-width: 640px) { .gallery-container { max-width: 520px; } }
         @media (min-width: 1024px) { .gallery-container { max-width: 700px; } }
        .gallery-viewport { overflow: hidden; padding-top: 1rem; margin-top: -1rem; }
        .gallery-wrapper { display: flex; transition: transform 0.5s ease-in-out; }
        .gallery-wrapper .case-study-card { flex: 0 0 100%; margin: 0; }
        @media (max-width: 768px) {
            .gallery-wrapper { scroll-snap-type: x mandatory; overflow-x: auto; scroll-behavior: smooth; }
            .gallery-wrapper .case-study-card { scroll-snap-align: start; min-width: 100%; }
        }
        .case-study-card {
            background-color: rgba(var(--nord-sym-deep-space-blue), 0.7);
            border: 1px solid rgba(var(--nord-sym-cyan-rgb), 0.3); backdrop-filter: blur(8px);
            border-radius: 1.5rem; padding: 2rem; display: flex; flex-direction: column;
        }
        .case-study-card:hover {
            box-shadow: 0 0 25px rgba(var(--nord-sym-cyan-rgb), 0.4), 0 4px 15px rgba(0,0,0,0.3);
            border-color: var(--nord-sym-cyan);
        }
        .case-study-card.frosted {
            backdrop-filter: blur(4px);
            opacity: 0.8;
            pointer-events: none;
            position: relative;
        }
        .case-study-card.frosted-heavy {
            backdrop-filter: blur(8px);
            opacity: 0.6;
            pointer-events: none;
            position: relative;
        }
        .case-study-card.frosted::after, .case-study-card.frosted-heavy::after {
            content: 'UNDER UTVECKLING';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
            font-family: 'Comfortaa', sans-serif;
            font-size: 1.5rem;
            font-weight: bold;
            color: rgba(255,255,255,0.5);
            border: 2px solid rgba(255,255,255,0.5);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        @media (min-width: 1024px) {
            .case-study-card { grid-template-columns: 1fr 1.5fr; gap: 2rem; display: grid; min-height: auto; padding: 2.5rem; }
        }
        .case-study-sidebar { display: flex; flex-direction: column; gap: 1rem; }
        .case-study-sidebar-item { display: flex; align-items: flex-start; gap: .75rem; }
        .case-study-sidebar-item i { font-size: 1.25rem; color: var(--nord-sym-cyan); margin-top: .1rem; flex-shrink: 0; }
        .case-study-sidebar-item h5 { font-size: 0.75rem; text-transform: uppercase; letter-spacing: .05em; color: var(--nord-sym-text-medium); margin-bottom: 0; }
        .case-study-sidebar-item p { font-weight: 500; color: var(--nord-sym-text-light); font-size: .875rem; }
        .case-study-main { display: flex; flex-direction: column; }
        .case-study-main h4 { font-family: 'Comfortaa', sans-serif; color: var(--nord-sym-light-accent); font-size: 1.25rem; margin-bottom: .5rem; }
        .case-study-main p { color: var(--nord-sym-text-medium); line-height: 1.6; margin-bottom: 1rem; font-size: .9rem; flex-grow: 1; }
        .case-study-results-grid { display: grid; gap: 1rem; border-top: 1px solid rgba(var(--nord-sym-cyan-rgb), 0.2); padding-top: 1rem; grid-template-columns: repeat(3, 1fr); }
        .case-study-result-item { text-align: center; }
        .case-study-result-item i { font-size: 1.5rem; color: var(--nord-sym-cyan); margin-bottom: .25rem; }
        .case-study-result-item .value { font-size: 1.1rem; font-weight: 700; color: var(--nord-sym-text-light); }
        .case-study-result-item .label { font-size: 0.7rem; color: var(--nord-sym-text-medium); }
        .gallery-nav {
            position: absolute; top: 50%; transform: translateY(-50%); z-index: 10;
            background-color: rgba(var(--nord-sym-deep-space-blue), 0.5); backdrop-filter: blur(5px);
            border: 1px solid rgba(var(--nord-sym-cyan-rgb), 0.3); border-radius: 50%;
            width: 44px; height: 44px; display: flex; align-items: center;
            justify-content: center; cursor: pointer; transition: all 0.3s ease;
        }
        .gallery-nav:hover { background-color: rgba(var(--nord-sym-cyan-rgb), 0.2); border-color: var(--nord-sym-cyan); }
        .gallery-nav i { font-size: 1.75rem; color: var(--nord-sym-text-light); }
        .gallery-nav.prev { left: -30px; }
        .gallery-nav.next { right: -30px; }
        @media (min-width: 640px) { .gallery-nav.prev { left: -50px; } .gallery-nav.next { right: -50px; } }
        .gallery-nav.disabled { opacity: 0.3; cursor: not-allowed; pointer-events: none; }
        @media (max-width: 768px) {
            .gallery-nav {
                display: flex;
                width: 40px; height: 40px;
            }
            .gallery-nav i { font-size: 1.5rem; }
            .gallery-nav.prev { left: 1rem; }
            .gallery-nav.next { right: 1rem; }
        }
        #main-footer {
            border: 1px solid rgba(0, 191, 255, 0.3);
            box-shadow: 0 0 10px rgba(0, 191, 255, 0.1);
        }
        .footer-quicklinks { display: flex; flex-direction: column; gap: 0.25rem; align-items: center; }
        @media (min-width: 768px) { .footer-quicklinks { align-items: flex-start; } }
        .footer-link { color: var(--nord-sym-text-medium); transition: color 0.3s ease; padding: 0.1rem 0; }
        .footer-link:hover { color: var(--nord-sym-cyan); }
        .nordsym-logo-star {
            color: var(--nord-sym-light-accent);
            animation: nordsym-logo-star-glow 3s infinite ease-in-out;
        }
        @keyframes nordsym-logo-star-glow { 50% { filter: drop-shadow(0 0 12px rgba(var(--nord-sym-light-accent-rgb), 0.8)); } }
        .sr-only {
            position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
            overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0;
        }
        .legal-content-container { color: var(--nord-sym-text-medium); }
        .legal-content-container h3 {
            font-family: 'Comfortaa', sans-serif; font-size: 1.5rem; font-weight: 700;
            color: var(--nord-sym-text-light); margin-top: 2rem; margin-bottom: 1rem;
            border-bottom: 1px solid rgba(var(--nord-sym-cyan-rgb), 0.2); padding-bottom: 0.5rem;
        }
         .legal-content-container h3:first-of-type { margin-top: 0; }
        .legal-content-container p, .legal-content-container li { font-size: 1rem; line-height: 1.7; margin-bottom: 1rem; }
        .legal-content-container ul { list-style-type: '• '; padding-left: 1.5rem; }
        .legal-content-container a { color: var(--nord-sym-cyan); text-decoration: underline; transition: color 0.3s; }
        .legal-content-container a:hover { color: var(--nord-sym-light-accent); }
        .hero-headline-glow { animation: hero-glow-animation 5s ease-in-out infinite; }
        @keyframes hero-glow-animation { 50% { text-shadow: 0 0 12px rgba(220, 240, 255, 0.6), 0 0 24px rgba(56, 189, 248, 0.4); } }
        
        /* --- UNIFIED CANVAS STYLES --- */
        #unified-geometry-canvas {
            position: fixed; top: 0; left: 0;
            width: 100vw; height: 100vh;
            z-index: -5;
            pointer-events: none;
            transition: opacity 0.5s ease-in-out;
        }
        #unified-geometry-canvas.interactive {
            cursor: grab;
            pointer-events: auto;
        }
        #unified-geometry-canvas.interactive:active {
            cursor: grabbing;
        }
        
        /* RITBORDET STYLES */
        #ritbordet {
            position: relative;
            height: 100%;
            overflow-y: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 140px 2rem 4rem 2rem;
        }
        #ritbordet-lobby {
            position: relative; z-index: 10;
            display: flex; flex-direction: column; align-items: center;
            width: 100%; text-align: center;
            transition: opacity 0.5s ease;
        }
        .ritbordet-grid {
            display: grid; gap: 1.5rem; width: 100%; max-width: 1100px;
        }
        @media (min-width: 768px) { .ritbordet-grid { grid-template-columns: repeat(3, 1fr); } }
        
        .ritbordet-card {
            background: rgba(var(--nord-sym-deep-space-blue), 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(var(--nord-sym-cyan-rgb), 0.2);
            padding: 2rem 1.5rem;
            display: flex; flex-direction: column;
            text-align: center; align-items: center;
            border-radius: 1rem; transition: all 0.3s ease;
            position: relative; z-index: 10;
        }
        .ritbordet-card:hover {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 0 25px rgba(var(--nord-sym-light-accent-rgb), 0.3);
            border-color: var(--nord-sym-light-accent);
        }
        .ritbordet-card i { font-size: 2.5rem; margin-bottom: 1rem; color: var(--nord-sym-cyan); }
        .ritbordet-card h4 { font-family: 'Comfortaa', sans-serif; font-size: 1.25rem; margin-bottom: 0.5rem; }
        .ritbordet-card p { font-size: 0.875rem; color: var(--nord-sym-text-medium); flex-grow: 1; }
        .ritbordet-card button { margin-top: 1.5rem; }
        .ritbordet-card.success-story .metric { font-size: 2rem; font-weight: bold; color: var(--nord-sym-light-accent); display: block; margin-bottom: 0.5rem; }
        .ritbordet-card.pricing-preview .price-range { font-size: 1.5rem; font-weight: bold; color: var(--nord-sym-light-accent); margin: 0.5rem 0; }

        .portal-btn-placeholder {
            display: flex; align-items: center; justify-content: center;
            width: 280px; height: 70px;
            margin: 2.5rem 0;
        }

        /* MOBILE LOBBY STYLES */
        #mobile-lobby-content { display: none; }

        @media (max-width: 767px) {
            #ritbordet-lobby .desktop-layout { display: none; }
            #mobile-lobby-content {
                display: block;
                width: 100%;
                padding-bottom: 120px; /* Space for floating button */
            }
            #mobile-lobby-content h3 {
                font-family: 'Comfortaa', sans-serif;
                font-size: 1.5rem;
                margin-top: 2rem;
                margin-bottom: 1rem;
                color: var(--nord-sym-light-accent);
                border-bottom: 1px solid rgba(var(--nord-sym-cyan-rgb), 0.2);
                padding-bottom: 0.5rem;
            }
             #mobile-lobby-content h3:first-child { margin-top: 0; }
        }

        /* --- JOYSTICK PORTAL CONTROLS --- */
        .joystick-portal {
            position: fixed;
            width: 60px; height: 60px;
            background: rgba(12, 20, 39, 0.6);
            border: 1px solid rgba(var(--nord-sym-cyan-rgb), 0.3);
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border-radius: 50%;
            z-index: 10002;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
            display: none; /* Hidden by default */
            align-items: center; justify-content: center;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }
        .joystick-portal:hover {
            background: rgba(var(--nord-sym-cyan-rgb), 0.1);
            border-color: var(--nord-sym-cyan);
            transform: scale(1.1);
        }
        .joystick-portal.active {
            background: rgba(var(--nord-sym-cyan-rgb), 0.2);
            border-color: var(--nord-sym-cyan);
            transform: scale(1.2);
        }
        .joystick-portal i {
            position: absolute; font-size: 2rem; color: var(--nord-sym-cyan);
            transition: transform 0.4s cubic-bezier(0.22, 1, 0.36, 1), opacity 0.4s ease;
        }
        
        /* Mobile-specific Joystick visibility */
        @media (max-width: 768px) {
            body.labb-active #joystick-portal-left { display: flex; }
            body.ritbordet-visible #joystick-portal-right { display: flex; }
            #joystick-portal-left { bottom: 30px; left: 30px; }
            #joystick-portal-right { bottom: 30px; right: 30px; }
        }

        /* Desktop & non-workshop Universal Atom logic */
        @media (min-width: 769px) {
            body:not(.labb-active).ritbordet-visible #joystick-portal-right {
                display: flex;
                position: absolute;
                top: 50%; left: 50%; bottom: auto; right: auto;
                transform: translate(-50%, -50%);
                width: 80px; height: 80px;
            }
             body:not(.labb-active).ritbordet-visible #joystick-portal-right:hover {
                 transform: translate(-50%, -50%) scale(1.1);
            }
             body:not(.labb-active).ritbordet-visible #joystick-portal-right i {
                font-size: 2.5rem;
            }
        }

        .portal-icon-exit {
            transform: rotate(-180deg) scale(0);
            opacity: 0;
        }
        body.labb-active #joystick-portal-right .portal-icon-enter {
            transform: rotate(180deg) scale(0);
            opacity: 0;
        }
        body.labb-active #joystick-portal-right .portal-icon-exit {
            transform: rotate(0deg) scale(1);
            opacity: 1;
        }

        /* Creator Mode Active State */
        body.creator-mode-active #elastic-toolbar {
            opacity: 0.1 !important;
            pointer-events: none;
        }

        /* GLASS TOOLBAR STYLES */
        #elastic-toolbar {
            position: fixed; left: 50%; top: auto; bottom: 30px;
            transform: translateX(-50%) translateY(120%);
            z-index: 10001; display: flex; flex-direction: column; gap: 1rem;
            opacity: 0; pointer-events: none;
            transition: opacity 0.5s ease 0.5s, transform 0.5s ease 0.5s;
            width: max-content;
        }
        #elastic-toolbar.visible {
            opacity: 1; pointer-events: auto;
            transform: translateX(-50%) translateY(0);
        }
        #elastic-toolbar.interaction-active {
            opacity: 0 !important;
            pointer-events: none;
        }
        .glass-control-group {
            background: rgba(12, 20, 39, 0.5);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: 16px; padding: 0.75rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            display: flex; gap: 0.5rem; align-items: center;
            transition: opacity 0.3s ease;
        }
        .glass-btn {
            width: 48px; height: 48px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 12px;
            color: var(--nord-sym-text-light); font-size: 1.5rem; font-weight: bold;
            cursor: pointer; transition: all 0.3s ease;
            position: relative; overflow: hidden;
            display: inline-flex; align-items: center; justify-content: center;
        }
        .glass-btn svg { width: 24px; height: 24px; }
        .glass-btn:hover {
            background: rgba(0, 212, 255, 0.1);
            border-color: rgba(0, 212, 255, 0.6);
            color: var(--nord-sym-cyan);
        }
        .glass-btn.active {
            background: rgba(0, 212, 255, 0.2);
            border-color: rgba(0, 212, 255, 0.8);
            color: var(--nord-sym-cyan);
        }
        #desktop-exit-btn {
            display: none; /* FÖRINTAD */
        }

        @media (max-width: 768px) { 
            #elastic-toolbar {
                left: 20px; top: auto; bottom: 110px; /* Position above joysticks */
                transform: translateY(120%);
                flex-direction: row;
                width: calc(100% - 40px);
            }
            #elastic-toolbar.visible { transform: translateY(0); }
            .glass-control-group { 
                flex-wrap: wrap; 
                justify-content: center;
                opacity: 0.3;
                transition: opacity 0.4s ease;
            }
            #elastic-toolbar.visible .glass-control-group:hover {
                opacity: 1;
            }
        }
        
        /* WORKSHOP ONBOARDING STYLES */
        #workshop-onboarding {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10005; display: flex; align-items: center; justify-content: center;
            background: rgba(12, 20, 39, 0.7); backdrop-filter: blur(10px);
            opacity: 0; pointer-events: none; transition: opacity 0.5s ease;
        }
        #workshop-onboarding.visible { opacity: 1; pointer-events: auto; }
        .onboarding-content {
            text-align: center; max-width: 500px; padding: 2rem;
            color: var(--nord-sym-text-light);
        }
        .onboarding-content h3 { font-family: 'Comfortaa', sans-serif; font-size: 2rem; margin-bottom: 1rem; }
        .onboarding-content p { color: var(--nord-sym-text-medium); line-height: 1.6; }
        .onboarding-content .esc-hint {
            margin-top: 1.5rem; font-size: 0.875rem; color: var(--nord-sym-cyan);
            animation: pulse 2s infinite ease-in-out;
        }
        @keyframes pulse { 50% { opacity: 0.6; } }
        
        /* FORM NAME DISPLAY in Header */
        #form-name-display {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1;
            padding: 0.25rem 1rem;
            background: rgba(12, 20, 39, 0);
            color: var(--nord-sym-light-accent);
            font-family: 'Source Code Pro', monospace;
            font-size: 0.875rem;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
            text-transform: capitalize;
            text-align: center;
            width: 100%;
        }
        body.labb-active #form-name-display.visible {
            opacity: 1;
        }

        /* NEW STYLES FOR ARKITEKTUR PAGE */
        #om-oss .arkitektur-grid {
            display: grid;
            gap: 2rem;
            margin-top: 4rem;
        }
        @media (min-width: 1024px) {
            #om-oss .arkitektur-grid {
                grid-template-columns: 1fr 1fr;
                gap: 4rem;
                align-items: start;
            }
        }
        #om-oss .arkitektur-list {
            list-style: none;
            padding: 0;
            margin-top: 1.5rem;
        }
        #om-oss .arkitektur-list li {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1rem;
            font-size: 1.125rem;
            color: var(--nord-sym-text-medium);
        }
        #om-oss .arkitektur-list i {
            color: var(--nord-sym-cyan);
            font-size: 1.5rem;
            margin-top: 0.2rem;
            flex-shrink: 0;
        }


    </style>
</head>
<body class="antialiased">
    <header id="header" class="fixed w-full top-0 left-0 right-0">
        <div class="container mx-auto px-4 md:px-6 py-4 relative"> 
            <div id="form-name-display"></div>
            <div class="flex items-center justify-between">
                <a href="#" id="header-logo-link" onclick="window.nord.showPage('hero'); return false;" class="hidden md:block flex-shrink-0">
                    <img src="https://raw.githubusercontent.com/GusHem/Logga-utan-text/refs/heads/main/Final%20logo%20no%20text.svg" alt="NordSym Logotyp" class="h-24 transition-all duration-300">
                </a>
                <button id="mobile-menu-trigger" class="md:hidden absolute left-4 top-1/2 -translate-y-1/2 z-50">
                    <img src="https://raw.githubusercontent.com/GusHem/Logga-utan-text/refs/heads/main/Final%20logo%20no%20text.svg" alt="NordSym Meny" class="h-16 transition-transform duration-300 ease-in-out">
                </button>
                <nav aria-label="Huvudnavigation" class="hidden md:flex flex-grow justify-center space-x-5 items-center header-nav">
                    <a href="#" onclick="window.nord.showPage('hero'); return false;" data-nav="hero" class="nav-link transition-colors font-medium">Hem</a>
                    <a href="#" onclick="window.nord.showPage('om-oss'); return false;" data-nav="om-oss" class="nav-link transition-colors font-medium">Arkitektur</a>
                    <a href="#" onclick="window.nord.showPage('system'); return false;" data-nav="system" class="nav-link transition-colors font-medium">System</a>
                    <a href="#" onclick="window.nord.showPage('ritbordet'); return false;" data-nav="ritbordet" class="nav-link transition-colors font-medium">Ritbordet</a>
                    <a href="#" onclick="window.nord.showPage('karriar'); return false;" data-nav="karriar" class="nav-link transition-colors font-medium">Gör din del</a>
                </nav>
                <div class="hidden md:block flex-shrink-0 header-cta"> 
                    <a href="#" onclick="window.nord.showPage('boka-samtal-skraddarsydd'); return false;" class="btn-base btn-cta-revised text-sm">Framtidsförsäkra er verksamhet</a>
                </div>
                 <div class="md:hidden w-16 h-16"></div> 
            </div>
        </div>
        <div id="mobile-menu" class="md:hidden bg-nord-sym-deep-space-blue/95 backdrop-blur-sm shadow-lg rounded-b-xl absolute w-full left-0 top-full">
            <a href="#" onclick="window.nord.showPage('hero'); return false;" data-nav="hero" class="block px-6 py-5 text-sky-100 hover:bg-sky-700/50 hover:nord-accent-text transition-colors">Hem</a>
            <a href="#" onclick="window.nord.showPage('om-oss'); return false;" data-nav="om-oss" class="block px-6 py-5 text-sky-100 hover:bg-sky-700/50 hover:nord-accent-text transition-colors">Arkitektur</a>
            <a href="#" onclick="window.nord.showPage('system'); return false;" data-nav="system" class="block px-6 py-5 text-sky-100 hover:bg-sky-700/50 hover:nord-accent-text transition-colors">System</a>
            <a href="#" onclick="window.nord.showPage('ritbordet'); return false;" data-nav="ritbordet" class="block px-6 py-5 text-sky-100 hover:bg-sky-700/50 hover:nord-accent-text transition-colors">Ritbordet</a>
            <a href="#" onclick="window.nord.showPage('karriar'); return false;" data-nav="karriar" class="block px-6 py-5 text-sky-100 hover:bg-sky-700/50 hover:nord-accent-text transition-colors">Gör din del</a>
            <div class="px-6 py-5">
                <a href="#" onclick="window.nord.showPage('boka-samtal-skraddarsydd'); return false;" data-nav="kontakt" class="btn-base btn-cta-revised w-full">Framtidsförsäkra er verksamhet</a>
            </div>
        </div>
    </header>

    <main> 
        <section id="hero" class="space-background-section">
            <div class="section-content-wrapper">
                <div class="flex flex-col items-center gap-y-8">
                    <div id="hero-logo-wrapper" onclick="window.nord.showPage('om-oss');">
                        <img src="https://raw.githubusercontent.com/GusHem/Logga-utan-text/refs/heads/main/Final%20logo%20no%20text.svg" alt="NordSym Logotyp" width="400" height="114">
                    </div>
                    <h1 class="text-5xl md:text-6xl font-bold leading-tight text-center hero-headline-glow" style="color: var(--nord-sym-light-accent);">
                        System som växer med framtiden
                    </h1>
                    <p class="text-lg md:text-xl text-sky-100 max-w-3xl mx-auto drop-shadow-sm text-center">
                        Där er unika process möter vår AI-arkitektur uppstår synergi. Vi orkestrerar system som inte bara arbetar för er – de tänker med er och utvecklas när AI utvecklas.
                    </p>
                    <div class="flex flex-col items-center gap-6">
                        <div class="flex flex-col md:flex-row items-center gap-4 md:gap-6">
                            <a href="#" onclick="window.nord.showPage('boka-samtal-skraddarsydd'); return false;" class="btn-base btn-cta-revised w-full md:w-auto">Framtidsförsäkra er verksamhet</a>
                            <a href="#" onclick="window.nord.showPage('ritbordet'); return false;" class="btn-base btn-secondary-on-dark w-full md:w-auto">Utforska Ritbordet</a>
                        </div>
                         <div class="flex flex-col sm:flex-row gap-4 sm:gap-8 mt-4 text-sm text-sky-300 justify-center">
                            <span>30 dagar till produktion</span>
                            <span>Byggt på beprövade mönster</span>
                            <span>🇸🇪 Svensk ingenjörskonst</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="home-diagram-section" class="space-background-section py-16 lg:py-24">
            <div class="section-content-wrapper">
                <div class="text-center mb-16 max-w-4xl mx-auto">
                    <h2 class="section-title text-4xl md:text-5xl mb-4">Vi förvandlar er expertis till <span class="nord-accent-text">intelligent kapacitet</span></h2>
                    <p class="text-lg text-sky-200 mt-6 leading-relaxed">Varje organisation har unika processer. Vi förstärker dem med system som tänker. Resultatet är mätbart, permanent och blir bättre över tid.</p>
                </div>
                <div class="venn-diagram-container">
                    <div class="venn-diagram-wrapper">
                        <div class="venn-circle venn-circle-1" id="vennCircle1">
                            <span class="venn-circle-text">ER UNIKA PROCESS</span>
                        </div>
                        <div class="venn-circle venn-circle-2" id="vennCircle2">
                             <span class="venn-circle-text">VÅR AI-ARKITEKTUR</span>
                        </div>
                        <div class="venn-overlap-text" onclick="window.nord.showPage('system'); return false;" style="cursor:pointer;">SYNERGI</div>
                    </div>
                </div>
            </div>
        </section>

        <section id="atom-gallery-section" class="space-background-section py-20 lg:py-28">
            <div class="section-content-wrapper">
                <div class="text-center mb-16">
                    <span class="inline-block bg-sky-800/50 text-sky-200 text-xs font-semibold px-3 py-1 rounded-full uppercase tracking-wider">Från Vision till Verklighet</span>
                    <h3 class="text-3xl md:text-4xl font-bold text-white mt-4">Vårt Galleri av System</h3>
                    <p class="text-center text-sky-200 max-w-2xl mx-auto mt-4 mb-8">
                        Ett urval av färdiga system och komponenter under utveckling som visar bredden av vår kapacitet.
                    </p>
                </div>
                <div class="gallery-container">
                    <div class="gallery-viewport">
                        <div id="galleryWrapper" class="gallery-wrapper">
                            <!-- Cards are dynamically injected by JS -->
                        </div>
                    </div>
                    <button aria-label="Föregående system i galleriet" id="galleryPrev" class="gallery-nav prev"><i class="ph-caret-left-bold"></i></button>
                    <button aria-label="Nästa system i galleriet" id="galleryNext" class="gallery-nav next"><i class="ph-caret-right-bold"></i></button>
                </div>
                <div class="text-center mt-12 max-w-2xl mx-auto">
                    <p class="text-sky-300 italic">Varje system du ser är en gestaltning av hundratals beprövade automationsarketyper, formade direkt för er digitala verklighet.</p>
                </div>
            </div>
        </section>

        <section id="home-contact-section" class="space-background-section py-20 lg:py-28">
            <div id="home-contact-anchor" class="absolute -top-24"></div>
            <div class="section-content-wrapper">
                 <div class="text-center mt-12 border-t border-sky-800/50 pt-16">
                    <h3 class="text-3xl font-bold text-white">Redo att påbörja er evolution?</h3>
                    <p class="text-lg text-content-dark-bg max-w-2xl mx-auto mt-4 mb-8">Låt oss boka ett strategisamtal för att definiera er arkitektur och påbörja er transformation.</p>
                    <a href="#" onclick="window.nord.showPage('boka-samtal-skraddarsydd'); return false;" class="btn-base btn-cta-revised px-10 py-4 text-lg">Framtidsförsäkra er verksamhet</a>
                </div>
            </div>
        </section>

        <section id="om-oss" class="space-background-section page-content-padding" style="display: none;">
            <div class="section-content-wrapper max-w-5xl mx-auto text-lg text-sky-100 leading-relaxed">
                <div class="text-center mb-16">
                    <h2 class="section-title text-4xl md:text-5xl">Vi bygger system för morgondagen.</h2>
                    <p class="mt-6 max-w-3xl mx-auto">
                        I en värld av snabba teknologiskiften designar NordSym intelligenta system byggda för att bestå. Vår grundfilosofi är enkel: sann teknologisk frihet uppnås genom modulär arkitektur som växer och anpassar sig med ert företag – inte låser in det.
                    </p>
                </div>

                <div class="text-center my-16 py-10 border-y border-sky-800/50">
                     <h3 class="section-title text-3xl md:text-4xl">Frihet över inlåsning.</h3>
                     <p class="mt-6 max-w-3xl mx-auto">
                        Vi använder dagens bästa och mest kraftfulla AI-verktyg för att ge er ett omedelbart försprång. Men vi bygger alltid för morgondagens frihet. Våra system designas med 'exit-ramps' – en medveten arkitektur som säkerställer att ni aldrig blir permanent beroende av en enskild teknikleverantör. När en bättre, snabbare eller mer kostnadseffektiv AI-modell dyker upp, är era system redo att växla. Vi prioriterar <strong>portabilitet</strong> över <strong>vendor lock-in</strong>, eftersom er framtid är viktigare än vår kortsiktiga bekvämlighet.
                     </p>
                </div>
                
                <div class="text-center mb-16">
                    <h3 class="section-title text-3xl md:text-4xl">Teknologi som tjänar människan.</h3>
                    <p class="mt-6 max-w-3xl mx-auto">
                        Vårt mål är inte snabba exits eller att bli uppköpta. Vi bygger för att bestå och för att skapa långsiktiga partnerskap. Vi tror på teknologi som stärker företag och de familjer som driver dem, som skapar stabilitet och möjliggör fokus på det som verkligen betyder något. För oss är den mest avancerade teknologin den som sömlöst tjänar er, inte tvärtom.
                    </p>
                </div>

                <div class="arkitektur-grid content-card-transparent card-base p-8 md:p-12">
                    <div>
                        <h4 class="section-title text-2xl md:text-3xl mb-4">Grundaren</h4>
                        <p>
                            <strong>Gustav Hemmingsson</strong> grundade NordSym med en tydlig vision: att företag och familjer ska äga sin teknologi, inte bli ägda av den. Med en bakgrund som sträcker sig över både avancerad systemarkitektur och strategisk affärsutveckling, förstår han att den bästa tekniken är den som bara fungerar – och ger er friheten att fokusera på er kärnverksamhet.
                        </p>
                    </div>
                    <div>
                        <h4 class="section-title text-2xl md:text-3xl mb-4">Ett fundament att lita på</h4>
                        <ul class="arkitektur-list">
                            <li><i class="ph-leaf"></i> <div><strong>Organisk Tillväxt:</strong> Byggt på förtroende och resultat, fritt från yttre investerarkrav.</div></li>
                            <li><i class="ph-stack"></i> <div><strong>Beprövad Teknologi:</strong> En kärna av n8n-automation, flexibel AI-integration och nordisk precision i varje detalj.</div></li>
                            <li><i class="ph-target"></i> <div><strong>Kundcentrerad Optimering:</strong> Vi är inte bundna till en specifik teknik; vi är bundna till att bygga den bästa, mest hållbara lösningen för er.</div></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section id="system" class="space-background-section page-content-padding" style="display: none;">
            <div class="section-content-wrapper flex-grow">
                <div class="text-center mb-20">
                     <span class="inline-block bg-sky-800/50 text-sky-200 text-xs font-semibold px-3 py-1 rounded-full uppercase tracking-wider">System</span>
                    <h3 class="text-3xl md:text-4xl font-bold text-white mt-4">En Transformation i Tre Steg</h3>
                     <p class="text-lg text-content-dark-bg max-w-3xl mx-auto mt-4">Vår arsenal av beprövade system är er startpunkt. Härifrån bygger vi er unika evolution.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto items-stretch">
                    <div class="pricing-card card-base">
                        <div class="pricing-card-header text-center">
                            <h3>GRUND</h3>
                             <p class="text-sm text-sky-300 mt-2">En fokuserad transformation. Mätbart resultat.</p>
                        </div>
                        <div class="price-display text-center">75k <span class="price-period">SEK</span></div>
                        <ul>
                            <li><i class="ph-check-circle"></i> En fundamental automationslösning</li>
                            <li><i class="ph-check-circle"></i> Perfekt för att testa och validera potentialen i automation</li>
                            <li><i class="ph-check-circle"></i> Snabb implementation för omedelbar ROI</li>
                            <li><i class="ph-check-circle"></i> Mer än ett flöde – det är den första, fullt integrerade komponenten i ert framtida ekosystem, inklusive all nödvändig arkitektur för att växa.</li>
                        </ul>
                        <div class="mt-auto">
                            <a href="#" onclick="window.nord.showPage('boka-samtal-skraddarsydd'); return false;" class="btn-base btn-secondary-on-dark w-full">Starta med Grunden</a>
                        </div>
                    </div>
                    <div class="pricing-card card-base ignite-package">
                         <div class="pricing-card-header text-center">
                            <h3>STRUKTUR</h3>
                             <p class="text-sm text-sky-300 mt-2">Sammankopplade system. Exponentiell effekt.</p>
                        </div>
                        <div class="price-display text-center">250k <span class="price-period">SEK</span></div>
                         <ul>
                            <li><i class="ph-check-circle"></i> Ett ekosystem av agenter</li>
                            <li><i class="ph-check-circle"></i> Byggd på beprövad arkitektur</li>
                            <li><i class="ph-check-circle"></i> Transformerar en hel avdelning eller process</li>
                            <li><i class="ph-check-circle"></i> Inkluderar ofta ett skräddarsytt gränssnitt</li>
                        </ul>
                         <div class="mt-auto">
                            <a href="#" onclick="window.nord.showPage('boka-samtal-skraddarsydd'); return false;" class="btn-base btn-cta-revised w-full">Forma er Struktur</a>
                        </div>
                    </div>
                    <div class="pricing-card card-base">
                         <div class="pricing-card-header text-center">
                            <h3>SYNERGI</h3>
                             <p class="text-sm text-sky-300 mt-2">Fullständig systemarkitektur. För de som tänker långsiktigt.</p>
                        </div>
                        <div class="price-display text-center">500k+ <span class="price-period">SEK</span></div>
                         <ul>
                            <li><i class="ph-check-circle"></i> Fullskalig, självgående företagsautomation</li>
                            <li><i class="ph-check-circle"></i> Obegränsad evolution och anpassning</li>
                            <li><i class="ph-check-circle"></i> AI som lär sig och växer med er verksamhet</li>
                            <li><i class="ph-check-circle"></i> Er framtidsförsäkring. Systemarkitektur som växer med AI-evolutionen</li>
                        </ul>
                         <div class="mt-auto">
                            <a href="#" onclick="window.nord.showPage('boka-samtal-skraddarsydd'); return false;" class="btn-base btn-secondary-on-dark w-full">Uppnå Synergi</a>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-16 max-w-3xl mx-auto">
                    <p class="text-lg text-sky-200"><strong>15k SEK/månad</strong> för framtidsbevakning. När AI utvecklas, utvecklas era system automatiskt.</p>
                    <p class="text-md text-sky-300 mt-2 italic">"Er framtidsförsäkring mot teknisk obsolescence."</p>
                </div>
            </div>
        </section>

        <section id="ritbordet" class="space-background-section" style="display: none;">
            <div id="ritbordet-lobby" class="section-content-wrapper">
                <div class="max-w-5xl mx-auto">
                    <!-- Desktop Layout -->
                    <div class="desktop-layout">
                        <div class="ritbordet-grid" id="ritbordet-grid-process">
                            <!-- Process cards injected by JS -->
                        </div>
                        <div class="portal-btn-placeholder relative">
                            <!-- Universal Portal Atom will be positioned here via CSS on desktop -->
                        </div>
                        <div class="ritbordet-grid" id="ritbordet-grid-value">
                            <!-- Value cards injected by JS -->
                        </div>
                    </div>
                    <!-- Mobile Layout -->
                    <div id="mobile-lobby-content"></div>
                </div>
            </div>
            <div id="workshop-onboarding">
                <div class="onboarding-content">
                    <h3>Välkommen till Ritbordet</h3>
                    <p class="text-lg">Här visualiserar vi hur era processer kan transformeras till intelligenta system. Varje form representerar en unik lösningsarkitektur.</p>
                    <div class="my-4 text-left max-w-xs mx-auto space-y-2">
                        <p><strong class="nord-accent-text">Transformera:</strong> Upptäck olika lösningsvägar</p>
                        <p><strong class="nord-accent-text">Rotera:</strong> Se möjligheter från nya vinklar</p>
                    </div>
                    <p class="font-semibold text-sky-200 italic">Systemtänkande i realtid.</p>
                    <p class="mt-4 text-xs text-sky-400 esc-hint">(Återvänd med ESC eller X)</p>
                </div>
            </div>
        </section>

        <section id="karriar" class="space-background-section page-content-padding" style="display: none;">
            <div class="section-content-wrapper text-center">
                 <div class="flex justify-center space-x-2 mb-8 md:mb-10">
                    <i class="ph-star-four nordsym-logo-star text-3xl" style="animation-delay: 0.1s;"></i>
                    <i class="ph-star-four nordsym-logo-star text-4xl" style="animation-delay: 0.3s;"></i>
                    <i class="ph-star-four nordsym-logo-star text-3xl" style="animation-delay: 0.5s;"></i>
                </div>
                <h2 class="section-title text-4xl md:text-5xl lg:text-6xl mb-8 md:mb-12">Gör din del i <span class="section-title-accent relative">systemrevolutionen</span></h2>
                <div class="max-w-3xl lg:max-w-4xl mx-auto">
                    <p class="text-lg md:text-xl leading-relaxed">
                        Vi bygger inte bara funktioner, vi bygger skalbara ekosystem som levererar mätbart affärsresultat. Vi söker mångsidiga arkitekter som vill transformera hur företag fungerar i grunden.
                    </p>
                    <p class="text-lg md:text-xl leading-relaxed mt-6">
                        Om du är en entreprenöriell tänkare som vill bygga system med bestående inverkan, har du hittat rätt.
                    </p>
                </div>
                <div class="mt-12 md:mt-16 mb-10">
                    <a href="#" onclick="window.nord.showPage('vilka-ar-vi'); return false;" class="btn-base btn-secondary-on-dark px-10 py-4 text-lg lg:text-xl lg:px-12 lg:py-5">
                        Starta Din Resa <i class="ph-paper-plane-tilt ml-2"></i>
                    </a>
                </div>
            </div>
        </section>
        
        <section id="vilka-ar-vi" class="space-background-section page-content-padding" style="display: none;">
            <div class="section-content-wrapper text-center" id="vilka-ar-vi-content">
                <h2 class="text-4xl md:text-5xl font-extrabold text-white mb-8">Vilka är vi?</h2>
                <div class="max-w-2xl mx-auto text-left text-sky-100">
                     <p class="text-lg mb-6">
                        Vi är <strong>arkitekter av intelligenta ekosystem</strong>. Vårt fokus är att bygga AI-drivna system som är designade att samverka och förstärka varandra. Vår vision är "Framtiden Förenklad", där avancerad teknologi blir ett kraftfullt och tillgängligt verktyg för företag som vill ligga i framkant.
                    </p>
                     <p class="text-lg mb-10">
                        Är du redo att ansluta dig till ett team som drivs av "Nordisk Atom-Optimism"?
                    </p>
                </div>
                <div id="jobApplicationFormContainer" class="content-card-dark card-base p-8 md:p-12 mt-10 max-w-2xl mx-auto text-left form-container"> 
                    <h3 class="text-2xl font-semibold text-heading-dark-bg mb-6 text-center">Anslut Till Teamet på NordSym</h3>
                    <div class="form-progress-bar">
                        <div class="form-progress-bar-inner"></div>
                    </div>
                    <form id="jobApplicationForm">
                        <input type="hidden" name="_subject" value="Ny jobbansökan från NordSym">
                        <div class="form-step active" data-step="1">
                            <div class="space-y-6">
                                <div>
                                    <label for="applicant-name" class="form-label">Ditt Namn</label>
                                    <input type="text" name="applicant-name" id="applicant-name" required class="form-input">
                                </div>
                                <div>
                                    <label for="applicant-email" class="form-label">E-post</label>
                                    <input type="email" name="email" id="applicant-email" required class="form-input">
                                </div>
                            </div>
                            <div class="form-navigation">
                                <span></span>
                                <button type="button" class="btn-base btn-cta-revised">Nästa <i class="ph-arrow-right"></i></button>
                            </div>
                        </div>
                        <div class="form-step" data-step="2">
                             <div class="space-y-6">
                                <div>
                                    <label for="applicant-linkedin" class="form-label">LinkedIn-profil (URL)</label>
                                    <input type="url" name="linkedin" id="applicant-linkedin" class="form-input" placeholder="https://linkedin.com/in/dittnamn">
                                </div>
                                <div>
                                    <label for="applicant-motivation" class="form-label">Varför vill du jobba med oss på NordSym?</label>
                                    <textarea name="motivation" id="applicant-motivation" rows="4" class="form-textarea" required placeholder="Berätta kort om din motivation och hur du kan bidra."></textarea>
                                </div>
                            </div>
                            <div class="form-navigation">
                                <button type="button" class="btn-base btn-secondary-on-dark"><i class="ph-arrow-left"></i> Föregående</button>
                                <button type="submit" class="btn-base btn-cta-revised">Skicka Intresseanmälan</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <section id="boka-samtal-skraddarsydd" class="space-background-section page-content-padding" style="display: none;">
            <div class="section-content-wrapper text-center">
                <h2 class="text-4xl md:text-5xl font-extrabold text-white mb-8">Diskutera ert system</h2>
                <p class="text-lg text-content-dark-bg max-w-xl mx-auto mb-10">Det första steget mot ert självgående ekosystem. Låt oss diskutera er vision.</p>
                <div id="formSkraddarsyddContainer" class="content-card-transparent card-base p-8 md:p-12 mt-10 max-w-lg mx-auto text-left form-container">
                    <h3 class="text-2xl font-semibold text-heading-dark-bg mb-6 text-center">Kontaktinformation</h3>
                    <div class="form-progress-bar">
                        <div class="form-progress-bar-inner"></div>
                    </div>
                    <form id="formSkraddarsydd">
                        <input type="hidden" name="_subject" value="Ny förfrågan: Systemdiskussion från NordSym">
                        <div class="form-step active" data-step="1">
                            <div class="space-y-6">
                                <div><label for="skraddarsydd-name" class="form-label">Ditt Namn</label><input type="text" name="name" id="skraddarsydd-name" required class="form-input"></div>
                                <div><label for="skraddarsydd-company" class="form-label">Företagsnamn</label><input type="text" name="company" id="skraddarsydd-company" required class="form-input"></div>
                                <div><label for="skraddarsydd-email" class="form-label">E-post</label><input type="email" name="email" id="skraddarsydd-email" required class="form-input"></div>
                            </div>
                             <div class="form-navigation">
                                <span></span>
                                <button type="button" class="btn-base btn-cta-revised">Nästa <i class="ph-arrow-right"></i></button>
                            </div>
                        </div>
                        <div class="form-step" data-step="2">
                            <div class="space-y-6">
                                <div><label for="skraddarsydd-phone" class="form-label">Telefon (valfritt)</label><input type="tel" name="phone" id="skraddarsydd-phone" class="form-input"></div>
                                <div><label for="skraddarsydd-main-goal" class="form-label">Vad är det viktigaste ni vill automatisera eller förbättra?</label><textarea name="main-goal" id="skraddarsydd-main-goal" rows="3" class="form-textarea" required></textarea></div>
                            </div>
                            <div class="form-navigation">
                                <button type="button" class="btn-base btn-secondary-on-dark"><i class="ph-arrow-left"></i> Föregående</button>
                                <button type="submit" class="btn-base btn-cta-revised">Boka diskussion</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </section>
        
        <section id="privacy-policy-en" class="space-background-section page-content-padding" style="display: none;">
            <div class="section-content-wrapper">
                <div class="legal-content-container max-w-4xl mx-auto text-left">
                    <h2 class="section-title text-4xl md:text-5xl mb-8 text-center">Privacy Policy</h2>
                    <p><strong>Last Updated: July 3, 2025</strong></p>
                    <h4>About This Policy</h4><p>NordSym AB (Swedish Org. No. 559535-5768) values your trust and privacy. This Privacy Policy describes how we collect, use, and protect your personal data when you visit our website or use our services.</p>
                    <h4>Who We Are</h4><p>NordSym AB<br>Organization Number: 559535-5768<br>Email: <a href="mailto:gustav@nordsym.com">gustav@nordsym.com</a><br>Website: nordsym.com</p><p>We are the data controller for the processing of personal data described in this policy.</p>
                    <h4>What Personal Data We Collect</h4><ul><li><strong>Contact Forms and Inquiries:</strong> Name and contact details (email, phone), company information, job title, and a description of your needs.</li><li><strong>Job Applications:</strong> Name, contact details, CV, professional background, relevant links (LinkedIn, etc.), and a motivational description.</li><li><strong>Website Usage:</strong> Anonymized IP address, browser information, and user interaction via cookies.</li><li><strong>Client and Project Data:</strong> Business processes, technical requirements, and communication history necessary for project delivery.</li></ul>
                    <h4>Why We Process Your Personal Data</h4><p>We process your data to fulfill our commitments (Art. 6.1.b GDPR), such as responding to inquiries and delivering services. We also have a legitimate interest (Art. 6.1.f GDPR) in developing our services and communicating with potential clients. For certain marketing activities, we obtain your consent (Art. 6.1.a GDPR).</p>
                    <h4>Data Sharing and Third Parties</h4><p>We use trusted service providers such as Formspree, Google Analytics, Microsoft 365, Notion, Airtable, GitHub, and leading AI platforms (Anthropic, OpenAI) as well as automation tools (Make, n8n) to conduct our business. All providers are selected to comply with GDPR requirements. We ensure an adequate level of protection for any transfers of data outside the EU/EEA.</p>
                    <h4>Your Rights</h4><p>You have the right to access, rectify, erase, restrict, and port your personal data, and to object to its processing. You can also withdraw your consent at any time. Contact <a href="mailto:gustav@nordsym.com">gustav@nordsym.com</a> to exercise your rights.</p>
                    <h4>Contact and Complaints</h4><p>For questions, contact us at <a href="mailto:gustav@nordsym.com">gustav@nordsym.com</a>. Complaints can be filed with the Swedish Authority for Privacy Protection (IMY).</p>
                </div>
            </div>
        </section>

        <section id="terms-of-service-en" class="space-background-section page-content-padding" style="display: none;">
            <div class="section-content-wrapper">
                <div class="legal-content-container max-w-4xl mx-auto text-left">
                    <h2 class="section-title text-4xl md:text-5xl mb-8 text-center">Terms of Service</h2>
                    <p><strong>Last Updated: July 3, 2025</strong></p>
                    <h4>General</h4><p>These Terms of Service govern your use of the NordSym AB ("we", "us", "NordSym") website (nordsym.com) and services. By using our services, you accept these terms.</p>
                    <h4>User Responsibilities</h4><p>You are responsible for providing accurate information and for not using our services for illegal purposes. You may not reverse engineer our systems or resell our services without written approval.</p>
                    <h4>Intellectual Property and Data Ownership</h4><p>NordSym äger våra algoritmer, metoder och ramverk. Du som kund behåller full äganderätt till dina affärsdata och de specifika resultat som genereras av dina data. För skräddarsydda AI-agenter utvecklade specifikt för dig, tillhör äganderätten dig, medan den underliggande tekniska plattformen förblir vår egendom.</p>
                    <h4>Limitation of Liability</h4><p>We are not liable for indirect damages such as lost profits or data. Our total liability is limited to the amount paid for the specific service. We do not guarantee specific business results or ROI, although that is our goal.</p>
                    <h4>Governing Law and Disputes</h4><p>These terms are governed by Swedish law. Disputes shall primarily be resolved through negotiation. If an agreement cannot be reached, the dispute shall be settled by a Swedish court.</p>
                </div>
            </div>
        </section>
    </main>
    
    <footer id="main-footer" class="relative bg-nord-sym-deep-space-blue">
        <div class="section-content-wrapper py-10 relative z-10">
            <div class="grid md:grid-cols-3 gap-8 text-sm">
                <div class="md:col-span-1 flex flex-col items-center md:items-start text-center md:text-left">
                    <a href="#" onclick="window.nord.showPage('hero'); return false;" class="inline-block mb-4">
                        <img src="https://raw.githubusercontent.com/GusHem/Logga-utan-text/refs/heads/main/Final%20logo%20no%20text.svg" alt="NordSym Logotyp" class="h-16" loading="lazy" decoding="async">
                    </a>
                    <p class="text-xs text-content-dark-bg">Intelligenta system med mänsklig insikt och teknologisk precision.</p>
                </div>
                <div class="md:col-span-1 text-center md:text-left">
                    <p class="font-semibold text-nord-sym-text-light mb-2">Snabblänkar</p>
                    <div class="footer-quicklinks">
                        <a href="#" onclick="window.nord.showPage('om-oss'); return false;" class="footer-link">Arkitektur</a>
                        <a href="#" onclick="window.nord.showPage('system'); return false;" class="footer-link">System</a>
                        <a href="#" onclick="window.nord.showPage('ritbordet'); return false;" class="footer-link">Ritbordet</a>
                        <a href="#" onclick="window.nord.showPage('karriar'); return false;" class="footer-link">Gör din del</a>
                    </div>
                </div>
                <div class="md:col-span-1 text-center md:text-left">
                     <p class="font-semibold text-nord-sym-text-light mb-2">Följ Oss</p>
                     <div class="footer-quicklinks">
                        <a href="https://www.linkedin.com/company/nordsym-ab/" target="_blank" rel="noopener noreferrer" class="footer-link inline-flex items-center gap-2"><i class="ph-linkedin-logo"></i>LinkedIn</a>
                        <a href="https://x.com/NordSym" target="_blank" rel="noopener noreferrer" class="footer-link inline-flex items-center gap-2"><i class="ph-twitter-logo"></i>X (Twitter)</a>
                        <a href="https://www.instagram.com/nordsym_ab/" target="_blank" rel="noopener noreferrer" class="footer-link inline-flex items-center gap-2"><i class="ph-instagram-logo"></i>Instagram</a>
                    </div>
                </div>
            </div>
            <div class="mt-8 border-t border-sky-700/50 pt-6 text-center text-xs text-content-dark-bg space-x-4">
                <span>© <span id="currentYear"></span> NordSym AB. Alla rättigheter förbehållna.</span>
                <a href="#privacy-policy-en" onclick="window.nord.showPage('privacy-policy-en'); return false;" class="footer-link hover:underline ml-4">Privacy Policy</a>
                <a href="#terms-of-service-en" onclick="window.nord.showPage('terms-of-service-en'); return false;" class="footer-link hover:underline">Terms of Service</a>
            </div>
        </div>
    </footer>
    
    <button id="joystick-portal-left" class="joystick-portal" title="Rotationskontroll">
        <i class="ph-arrows-out-cardinal"></i>
    </button>
    <button id="joystick-portal-right" class="joystick-portal" title="Gå in i / Lämna Ritbordet & Transformationskontroll">
        <i class="ph-atom portal-icon-enter"></i>
        <i class="ph-x portal-icon-exit"></i>
    </button>

    <div id="elastic-toolbar">
        <div class="glass-control-group">
            <button class="glass-btn" data-theme="neural" title="Platonska Solider">◉</button>
            <button class="glass-btn" data-theme="organic" title="Helig Geometri">◊</button>
            <button class="glass-btn" data-theme="crystal" title="Kristaller">Ψ</button>
            <button class="glass-btn" data-theme="quantum" title="Kvantum">∞</button>
            <button class="glass-btn active" data-theme="cosmic" title="Kosmisk">⟠</button>
            <button class="glass-btn" id="fractal-mode-toggle" title="Partikel-manifestation">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2 C 17 7, 7 17, 2 12 C 7 7, 17 17, 22 12 C 17 7, 7 7, 12 2"></path></svg>
            </button>
        </div>
    </div>

    <script id="simplex-noise-glsl" type="x-shader/x-fragment">
        // Simplex Noise GLSL implementation
        vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
        vec4 mod289(vec4 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
        vec4 permute(vec4 x) { return mod289(((x*34.0)+1.0)*x); }
        vec4 taylorInvSqrt(vec4 r) { return 1.79284291400159 - 0.85373472095314 * r; }

        float snoise(vec3 v) {
            const vec2 C = vec2(1.0/6.0, 1.0/3.0);
            const vec4 D = vec4(0.0, 0.5, 1.0, 2.0);
            vec3 i  = floor(v + dot(v, C.yyy));
            vec3 x0 = v - i + dot(i, C.xxx);
            vec3 g = step(x0.yzx, x0.xyz);
            vec3 l = 1.0 - g;
            vec3 i1 = min(g.xyz, l.zxy);
            vec3 i2 = max(g.xyz, l.zxy);
            vec3 x1 = x0 - i1 + C.xxx;
            vec3 x2 = x0 - i2 + C.yyy;
            vec3 x3 = x0 - D.yyy;
            i = mod289(i);
            vec4 p = permute(permute(permute(i.z + vec4(0.0, i1.z, i2.z, 1.0)) + i.y + vec4(0.0, i1.y, i2.y, 1.0)) + i.x + vec4(0.0, i1.x, i2.x, 1.0));
            float n_ = 0.142857142857; // 1.0/7.0
            vec3 ns = n_ * D.wyz - D.xzx;
            vec4 j = p - 49.0 * floor(p * ns.z * ns.z);
            vec4 x_ = floor(j * ns.z);
            vec4 y_ = floor(j - 7.0 * x_);
            vec4 x = x_ * ns.x + ns.yyyy;
            vec4 y = y_ * ns.x + ns.yyyy;
            vec4 h = 1.0 - abs(x) - abs(y);
            vec4 b0 = vec4(x.xy, y.xy);
            vec4 b1 = vec4(x.zw, y.zw);
            vec4 s0 = floor(b0)*2.0 + 1.0;
            vec4 s1 = floor(b1)*2.0 + 1.0;
            vec4 sh = -step(h, vec4(0.0));
            vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy;
            vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww;
            vec3 p0 = vec3(a0.xy,h.x);
            vec3 p1 = vec3(a0.zw,h.y);
            vec3 p2 = vec3(a1.xy,h.z);
            vec3 p3 = vec3(a1.zw,h.w);
            vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2,p2), dot(p3,p3)));
            p0 *= norm.x; p1 *= norm.y; p2 *= norm.z; p3 *= norm.w;
            vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
            m = m * m;
            return 42.0 * dot(m*m, vec4(dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3)));
        }
    </script>

    <script>
    /**
     * ATOMSMED vFINAL: TOTAL HARMONI (Anti-Fragile Manifestation)
     * "Från universum till användare. Klarhet genom magi, inte trots den."
     * MANIFESTATION PROTOCOL: Systemet har uppnått universell harmoni. Alla dimensioner är synkroniserade.
     */

    // --- GLOBAL NAMESPACE & STATE MANAGEMENT ---
    window.nord = {};
    window.UnifiedGeometryManager = null;

    const SACRED_GEOMETRY_LIBRARY = {
        neural: { material: 'neural', forms: [{ name: 'tetrahedron' }, { name: 'cube' }, { name: 'octahedron' }, { name: 'dodecahedron' }, { name: 'icosahedron' }], currentIndex: 0 },
        organic: { material: 'organic', forms: [{ name: 'seed_of_life' }, { name: 'flower_of_life' }, { name: 'metatrons_cube' }, { name: 'torus' }, { name: 'trinity_knot' }], currentIndex: 0 },
        crystal: { material: 'crystal', forms: [{ name: 'diamond_brilliant' }, { name: 'quartz_point' }, { name: 'bismuth_spiral' }, { name: 'geode' }, { name: 'prism_triangular' }], currentIndex: 0 },
        quantum: { material: 'quantum', forms: [{ name: 'tesseract' }, { name: 'klein_bottle' }, { name: 'mobius_strip' }, { name: 'hopf_fibration' }, { name: 'calabi_yau' }], currentIndex: 0 },
        cosmic: { 
            material: 'nebula', 
            forms: [
                { name: 'galaxy_spiral' }, 
                { name: 'galactic_arm' }, 
                { name: 'cosmic_web' }, 
                { name: 'supernova_remnant' }, 
                { name: 'accretion_disk' }, 
                { name: 'stellated_dodecahedron' }, 
                { name: 'merkaba' }, 
                { name: 'atomic_orbitals' }, 
                { name: 'fibonacci_sphere' }, 
                { name: 'fibonacci_spiral' },
                { name: 'tetrahedron_grid_64' }, 
                { name: 'nebula_cloud' }
            ], 
            currentIndex: 0 
        },
        fractal_reference: { material: 'nebula', forms: [{ name: 'fractal_fibonacci' }] }
    };

    // --- ANTI-FRAGILE CORE ---
    function logToExternalService(error, context) {
        // I en verklig applikation skulle detta skicka data till en tjänst som Sentry, LogRocket, etc.
        console.warn(`[EXTERNAL LOG] Disharmoni observerad i ${context}:`, error);
    }

    // --- CORE PAGE ROUTING LOGIC ---
    document.addEventListener('DOMContentLoaded', () => {
        // KALIBRERING: Neutralisera webbläsarens scroll-återställning för att säkerställa harmonisk start.
        if ('scrollRestoration' in history) {
            history.scrollRestoration = 'manual';
        }
        window.scrollTo(0, 0);

        const pageConfig = {
            'hero': { isMultiPart: true, parts: ['hero', 'home-diagram-section', 'atom-gallery-section', 'home-contact-section'], display: 'flex', hasFooter: true, navAlias: 'hero' },
            'om-oss': { display: 'flex', hasFooter: true, navAlias: 'om-oss' },
            'system': { display: 'flex', hasFooter: true, navAlias: 'system' },
            'ritbordet': { display: 'flex', hasFooter: false, navAlias: 'ritbordet' },
            'karriar': { display: 'flex', hasFooter: false, navAlias: 'karriar' },
            'vilka-ar-vi': { display: 'flex', hasFooter: false, navAlias: 'karriar' },
            'boka-samtal-skraddarsydd': { display: 'flex', hasFooter: true, navAlias: 'system' },
            'privacy-policy-en': { display: 'flex', hasFooter: true, navAlias: 'hero' },
            'terms-of-service-en': { display: 'flex', hasFooter: true, navAlias: 'hero' },
        };

        window.nord.showPage = function(pageId, isPoppingState = false) {
            const config = pageConfig[pageId];
            if (!config) return;

            document.body.classList.toggle('ritbordet-visible', pageId === 'ritbordet');

            const targetState = pageId === 'ritbordet' ? 'WORKSHOP' : (pageId === 'hero' ? 'HERO' : 'PAGE');
            
            const main = document.querySelector('main');
            gsap.to(main, { opacity: 0, duration: 0.4, ease: 'power2.in', onComplete: () => {
                document.querySelectorAll('main > section').forEach(s => s.style.display = 'none');
                const footer = document.getElementById('main-footer');
                if (footer) footer.style.display = config.hasFooter ? 'block' : 'none';
                
                if (config.isMultiPart) {
                    config.parts.forEach(partId => document.getElementById(partId)?.style.setProperty('display', config.display, 'important'));
                } else {
                    document.getElementById(pageId)?.style.setProperty('display', config.display, 'important');
                }

                if (config.initFn) config.initFn();
                window.nord.updateActiveLink(config.navAlias || pageId);
                
                // KALIBRERING: Säkerställ att vyn är vid toppen vid sidbyte, förutom vid återgång från ritbordet.
                if (window.UnifiedGeometryManager && window.UnifiedGeometryManager.lastState !== 'WORKSHOP') {
                    window.scrollTo({ top: 0, left: 0, behavior: 'instant' });
                }

                requestAnimationFrame(() => {
                    gsap.to(main, { opacity: 1, duration: 0.6, ease: 'power2.out' });
                });
            }});
            
            if (window.UnifiedGeometryManager && !window.UnifiedGeometryManager.initializationFailed) {
                window.UnifiedGeometryManager.transitionTo(targetState);
            }
            
            window.nord.closeMobileMenu();
        };

        class UnifiedGeometryManager {
            constructor() {
                this.isInitialized = false;
                this.initializationFailed = false;
                this.composer = null;
                this.states = {
                    HERO: { zoom: 15, y: 0, opacity: 0.15, rotSpeed: 0.1 },
                    PAGE: { zoom: 35, y: 10, opacity: 0.3, rotSpeed: 0.05 },
                    WORKSHOP: { zoom: 22, y: 0, opacity: 1.0, rotSpeed: 0.2 }, // KALIBRERING: Zoom justerad
                    HIDDEN: { zoom: 50, y: 20, opacity: 0.0, rotSpeed: 0.02 }
                };
                this.currentState = 'HIDDEN';
                this.lastState = 'HIDDEN';
                this.targetState = this.states.HIDDEN;
                
                this.activeTheme = 'cosmic';
                this.activeShape = 'galaxy_spiral';
                
                this.isMorphing = false;
                this.currentMorphProgress = 0;
                this.isFractalMode = false;
                this.isWorkshopBuilderActive = false;
                
                this.morphVelocity = 0;
                this.dampingFactor = 0.90;
                this.forceFactor = 0.0015;
                this.MAX_INPUT_FORCE = 0.035;

                this.interaction = {
                    targetRotationX: 0.5, targetRotationY: 0,
                    actualRotationX: 0.5, actualRotationY: 0,
                    targetZoom: this.states.HIDDEN.zoom, actualZoom: this.states.HIDDEN.zoom,
                    targetY: this.states.HIDDEN.y, actualY: this.states.HIDDEN.y
                };
                
                this.joystick = {
                    left: { active: false, id: null, startX: 0, startY: 0, currentX: 0, currentY: 0 },
                    right: { active: false, id: null, startX: 0, startY: 0, currentX: 0, currentY: 0 },
                    creatorMode: false,
                    rightTapTimeout: null
                };

                this.boundWheelHandler = this.handleWheel.bind(this);
                this.boundJoystickTouchStart = this.handleJoystickTouchStart.bind(this);
                this.boundJoystickTouchMove = this.handleJoystickTouchMove.bind(this);
                this.boundJoystickTouchEnd = this.handleJoystickTouchEnd.bind(this);
            }

            init() {
                try {
                    if (this.isInitialized) return;
                    this.initRenderer();
                    
                    this.stars = new GlobalStarfield(this.scene);

                    this.elasticGeometry = new ElasticGeometry(this.renderer);
                    this.scene.add(this.elasticGeometry.mesh);
                    
                    this.setTheme(this.activeTheme);

                    this.setupInteractionListeners();
                    window.addEventListener('resize', () => this.handleResize(), false);

                    this.animate = this.animate.bind(this);
                    this.animate();
                    this.isInitialized = true;
                } catch (error) {
                    this.initializationFailed = true;
                    console.error("Total disharmoni i UnifiedGeometryManager:", error);
                    logToExternalService(error, "UnifiedGeometryManager.init");
                }
            }

            initRenderer() {
                this.canvas = document.createElement('canvas');
                this.canvas.id = 'unified-geometry-canvas';
                document.body.appendChild(this.canvas);
                this.renderer = new THREE.WebGLRenderer({ canvas: this.canvas, alpha: true, antialias: true, powerPreference: 'high-performance' });
                this.scene = new THREE.Scene();
                this.scene.fog = new THREE.FogExp2(0x0c1427, 0.015);
                this.camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);
                
                if (typeof THREE.EffectComposer !== 'undefined' && typeof THREE.UnrealBloomPass !== 'undefined') {
                    this.composer = new THREE.EffectComposer(this.renderer);
                    this.composer.addPass(new THREE.RenderPass(this.scene, this.camera));
                    const bloomPass = new THREE.UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.3, 0.4, 0.8);
                    this.composer.addPass(bloomPass);
                } else {
                    this.composer = null;
                }
                this.handleResize();
            }

            setupInteractionListeners() {
                const isTouchDevice = window.matchMedia('(pointer: coarse)').matches;
                const joystickLeft = document.getElementById('joystick-portal-left');
                const joystickRight = document.getElementById('joystick-portal-right');

                if (isTouchDevice && joystickLeft && joystickRight) {
                    joystickLeft.addEventListener('touchstart', (e) => this.boundJoystickTouchStart(e, 'left'), { passive: false });
                    joystickRight.addEventListener('touchstart', (e) => this.boundJoystickTouchStart(e, 'right'), { passive: false });
                    
                    window.addEventListener('touchmove', this.boundJoystickTouchMove, { passive: false });
                    window.addEventListener('touchend', this.boundJoystickTouchEnd, { passive: false });
                    window.addEventListener('touchcancel', this.boundJoystickTouchEnd, { passive: false });
                } else {
                    window.addEventListener('wheel', this.boundWheelHandler, { passive: false });
                    if (joystickRight) {
                        joystickRight.addEventListener('click', () => {
                             if (document.body.classList.contains('labb-active')) { this.exitBuilderMode(); }
                             else { this.enterBuilderMode(); }
                        });
                    }
                }
                
                document.querySelectorAll('.glass-btn[data-theme]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.setTheme(btn.dataset.theme);
                        document.querySelectorAll('.glass-btn[data-theme]').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                    });
                });

                document.getElementById('fractal-mode-toggle').addEventListener('click', (e) => {
                    this.toggleFractalMode();
                    e.currentTarget.classList.toggle('active', this.isFractalMode);
                });

                window.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && this.isWorkshopBuilderActive) this.exitBuilderMode();
                });
            }

            handleWheel(e) {
                if (!this.isWorkshopBuilderActive) return;
                e.preventDefault();
                const rawForce = e.deltaY * this.forceFactor;
                const force = Math.max(-this.MAX_INPUT_FORCE, Math.min(this.MAX_INPUT_FORCE, rawForce));
                this.morphVelocity += force;
                this.isMorphing = true;
            }

            handleJoystickTouchStart(e, side) {
                e.preventDefault();
                const touch = e.changedTouches[0];
                this.joystick[side].active = true;
                this.joystick[side].id = touch.identifier;
                this.joystick[side].startX = touch.clientX;
                this.joystick[side].startY = touch.clientY;
                this.joystick[side].currentX = touch.clientX;
                this.joystick[side].currentY = touch.clientY;
                e.currentTarget.classList.add('active');

                if (this.joystick.left.active && this.joystick.right.active) {
                    this.joystick.creatorMode = true;
                    document.body.classList.add('creator-mode-active');
                }

                if (side === 'right') {
                    clearTimeout(this.joystick.rightTapTimeout);
                    this.joystick.rightTapTimeout = setTimeout(() => {
                        // If timeout fires, it's a hold, not a tap
                        this.joystick.rightTapTimeout = null;
                    }, 200);
                }
            }

            handleJoystickTouchMove(e) {
                if (!this.joystick.creatorMode) return;
                e.preventDefault();

                for (let i = 0; i < e.changedTouches.length; i++) {
                    const touch = e.changedTouches[i];
                    if (touch.identifier === this.joystick.left.id) {
                        const deltaX = touch.clientX - this.joystick.left.currentX;
                        const deltaY = touch.clientY - this.joystick.left.currentY;
                        this.interaction.targetRotationY += deltaX * 0.008;
                        this.interaction.targetRotationX -= deltaY * 0.008;
                        this.interaction.targetRotationX = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, this.interaction.targetRotationX));
                        this.joystick.left.currentX = touch.clientX;
                        this.joystick.left.currentY = touch.clientY;
                    } else if (touch.identifier === this.joystick.right.id) {
                        const deltaX = touch.clientX - this.joystick.right.currentX;
                        const deltaY = touch.clientY - this.joystick.right.currentY;
                        
                        // Vertical for Morph
                        const rawForce = -deltaY * this.forceFactor * 3.0;
                        const force = Math.max(-this.MAX_INPUT_FORCE, Math.min(this.MAX_INPUT_FORCE, rawForce));
                        this.morphVelocity += force;
                        this.isMorphing = true;

                        // Horizontal for Zoom
                        this.interaction.targetZoom = Math.max(10, Math.min(50, this.interaction.targetZoom - deltaX * 0.1));

                        this.joystick.right.currentX = touch.clientX;
                        this.joystick.right.currentY = touch.clientY;
                    }
                }
            }

            handleJoystickTouchEnd(e) {
                for (let i = 0; i < e.changedTouches.length; i++) {
                    const touch = e.changedTouches[i];
                    if (touch.identifier === this.joystick.left.id) {
                        this.joystick.left.active = false;
                        this.joystick.left.id = null;
                        document.getElementById('joystick-portal-left').classList.remove('active');
                    } else if (touch.identifier === this.joystick.right.id) {
                         if (this.joystick.rightTapTimeout) {
                            clearTimeout(this.joystick.rightTapTimeout);
                            this.joystick.rightTapTimeout = null;
                            if (this.isWorkshopBuilderActive) this.exitBuilderMode();
                            else this.enterBuilderMode();
                        }
                        this.joystick.right.active = false;
                        this.joystick.right.id = null;
                        document.getElementById('joystick-portal-right').classList.remove('active');
                    }
                }

                if (!this.joystick.left.active || !this.joystick.right.active) {
                    if (this.joystick.creatorMode) {
                        this.joystick.creatorMode = false;
                        document.body.classList.remove('creator-mode-active');
                    }
                }
            }

            transitionTo(newStateKey, onComplete = () => {}) {
                if (!this.states[newStateKey] || this.currentState === newStateKey) { if(onComplete) onComplete(); return; }
                this.lastState = this.currentState; this.currentState = newStateKey; this.targetState = this.states[newStateKey];
                const duration = 1.2;
                gsap.to(this.interaction, { targetZoom: this.targetState.zoom, targetY: this.targetState.y, duration: duration, ease: "power2.inOut", onComplete: onComplete });
                const material = this.elasticGeometry.mesh.material;
                gsap.to(material.uniforms?.opacity || material, { value: this.targetState.opacity, duration: duration, ease: "power2.inOut" });
                if (newStateKey !== 'WORKSHOP') this.exitBuilderMode(false);
            }
            
            enterBuilderMode() {
                this.isWorkshopBuilderActive = true;
                document.body.classList.add('labb-active');
                gsap.to('#ritbordet-lobby', { opacity: 0, duration: 0.5, onComplete: () => document.getElementById('ritbordet-lobby').style.pointerEvents = 'none' });
                document.getElementById('elastic-toolbar').classList.add('visible');
                this.canvas.classList.add('interactive');
                this.showOnboarding();
            }

            exitBuilderMode(animate = true) {
                if (!this.isWorkshopBuilderActive) return;
                this.isWorkshopBuilderActive = false;
                document.body.classList.remove('labb-active');
                if (animate) gsap.to('#ritbordet-lobby', { opacity: 1, duration: 0.5, delay: 0.5, onStart: () => document.getElementById('ritbordet-lobby').style.pointerEvents = 'auto' });
                else { document.getElementById('ritbordet-lobby').style.opacity = 1; document.getElementById('ritbordet-lobby').style.pointerEvents = 'auto'; }
                document.getElementById('elastic-toolbar').classList.remove('visible');
                this.canvas.classList.remove('interactive');
                this.hideOnboarding(); this.hideFormName();
            }

            showOnboarding() {
                const onboarding = document.getElementById('workshop-onboarding'); if (!onboarding) return;
                onboarding.classList.add('visible');
                const hide = () => { this.hideOnboarding(); window.removeEventListener('wheel', hide); window.removeEventListener('click', hide); };
                setTimeout(() => { window.addEventListener('wheel', hide, { once: true }); window.addEventListener('click', hide, { once: true }); }, 500);
                // KALIBRERING: Tidsgräns för onboarding reducerad.
                setTimeout(hide, 5000);
            }

            hideOnboarding() { document.getElementById('workshop-onboarding')?.classList.remove('visible'); }
            
            setTheme(themeKey) {
                if (!SACRED_GEOMETRY_LIBRARY[themeKey]) return;
                this.activeTheme = themeKey; const theme = SACRED_GEOMETRY_LIBRARY[themeKey]; theme.currentIndex = 0;
                this.isMorphing = false; this.currentMorphProgress = 0; this.morphVelocity = 0;
                const materialKey = this.isFractalMode ? 'nebula' : theme.material;
                this.elasticGeometry.setMaterial(materialKey);
                this.activeShape = theme.forms[theme.currentIndex].name;
                this.elasticGeometry.morphToShape(this.activeShape);
                this.displayFormName(this.activeShape);
            }
            
            toggleFractalMode() {
                this.isFractalMode = !this.isFractalMode; const theme = SACRED_GEOMETRY_LIBRARY[this.activeTheme];
                const materialKey = this.isFractalMode ? 'nebula' : theme.material;
                this.elasticGeometry.setMaterial(materialKey); this.elasticGeometry.morphToShape(this.activeShape);
            }
            
            displayFormName(name) {
                if (!this.isWorkshopBuilderActive) return;
                const el = document.getElementById('form-name-display'); if (!el) return;
                el.textContent = name.replace(/_/g, ' '); el.classList.add('visible');
            }
            
            hideFormName() { document.getElementById('form-name-display')?.classList.remove('visible'); }

            animate() {
                requestAnimationFrame(this.animate);
                const time = Date.now() * 0.001;
                this.interaction.actualRotationX += (this.interaction.targetRotationX - this.interaction.actualRotationX) * 0.1;
                this.interaction.actualRotationY += (this.interaction.targetRotationY - this.interaction.actualRotationY) * 0.1;
                this.interaction.actualZoom += (this.interaction.targetZoom - this.interaction.actualZoom) * 0.05;
                this.interaction.actualY += (this.interaction.targetY - this.interaction.actualY) * 0.05;
                
                if (this.isWorkshopBuilderActive) {
                    this.currentMorphProgress += this.morphVelocity; this.morphVelocity *= this.dampingFactor;
                    if (Math.abs(this.morphVelocity) < 0.0001) { this.morphVelocity = 0; if(this.isMorphing) this.isMorphing = false; }
                    const theme = SACRED_GEOMETRY_LIBRARY[this.activeTheme];
                    if (this.currentMorphProgress >= 1) { theme.currentIndex = (theme.currentIndex + 1) % theme.forms.length; this.activeShape = theme.forms[theme.currentIndex].name; this.currentMorphProgress -= 1.0; if ('vibrate' in navigator) navigator.vibrate(30); } 
                    else if (this.currentMorphProgress < 0) { theme.currentIndex = (theme.currentIndex - 1 + theme.forms.length) % theme.forms.length; this.activeShape = theme.forms[theme.currentIndex].name; this.currentMorphProgress += 1.0; if ('vibrate' in navigator) navigator.vibrate(30); }
                    const fromShape = theme.forms[theme.currentIndex].name, toShape = theme.forms[(theme.currentIndex + 1) % theme.forms.length].name;
                    this.elasticGeometry.setMorph(fromShape, toShape, this.currentMorphProgress);
                    this.displayFormName(this.isMorphing ? `${fromShape.replace(/_/g, ' ')} → ${toShape.replace(/_/g, ' ')}` : this.activeShape.replace(/_/g, ' '));
                }
                
                const cameraX = Math.sin(this.interaction.actualRotationY) * Math.cos(this.interaction.actualRotationX) * this.interaction.actualZoom;
                const cameraZ = Math.cos(this.interaction.actualRotationY) * Math.cos(this.interaction.actualRotationX) * this.interaction.actualZoom;
                const cameraY = this.interaction.actualY + Math.sin(this.interaction.actualRotationX) * this.interaction.actualZoom;
                this.camera.position.set(cameraX, cameraY, cameraZ);
                this.camera.lookAt(this.scene.position);
                this.elasticGeometry.mesh.rotation.y = time * this.targetState.rotSpeed;
                this.stars.update(time); this.elasticGeometry.update(time);
                if (this.composer) { this.composer.render(); } else { this.renderer.render(this.scene, this.camera); }
            }

            handleResize() {
                if (!this.renderer) return;
                this.camera.aspect = window.innerWidth / window.innerHeight;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                if (this.composer) this.composer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            }
        }
        
        class GlobalStarfield {
            constructor(renderTarget) { this.renderTarget = renderTarget; this.initStars(); }
            initStars() {
                const geometry = new THREE.BufferGeometry(); const vertices = [], sizes = [];
                for(let i = 0; i < 10000; i++) { vertices.push((Math.random() - 0.5) * 300, (Math.random() - 0.5) * 300, (Math.random() - 0.5) * 300); sizes.push(Math.random() * 2.5); }
                geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3)); geometry.setAttribute('size', new THREE.Float32BufferAttribute(sizes, 1));
                this.material = new THREE.ShaderMaterial({
                    uniforms: { time: { value: 0 }, opacity: { value: 1.0 } },
                    vertexShader: `attribute float size; varying float vSize; void main() { vSize = size; vec4 mvPosition = modelViewMatrix * vec4(position, 1.0); gl_PointSize = size * (300.0 / -mvPosition.z); gl_Position = projectionMatrix * mvPosition; }`,
                    fragmentShader: `varying float vSize; uniform float time; uniform float opacity; void main() { float dist = length(gl_PointCoord - vec2(0.5)); if (dist > 0.5) discard; float a = smoothstep(0.5, 0.0, dist); a *= 0.6 + 0.4 * sin(time + vSize * 10.0); gl_FragColor = vec4(1.0, 1.0, 1.0, a * opacity); }`,
                    transparent: true, blending: THREE.AdditiveBlending, depthWrite: false
                });
                this.stars = new THREE.Points(geometry, this.material); this.stars.renderOrder = -2; this.renderTarget.add(this.stars);
            }
            update(time) { if(this.stars) { this.material.uniforms.time.value = time; this.stars.rotation.x = time * 0.02; this.stars.rotation.y = time * 0.01; } }
        }
        
        class ElasticGeometry {
            constructor(renderer) {
                this.renderer = renderer; this.SPRING_STRENGTH = 0.04; this.DAMPING = 0.88; this.velocityThreshold = 0.0001; this.isParticleSystem = false; this.activeMorph = null;
                this.initGeometry(); this.initPhysics(); this.initMaterials(); this.initVisuals();
            }

            _addColorAttribute(geometry) {
                if (geometry.attributes.color) return;
                const count = geometry.attributes.position.count;
                const colors = new Float32Array(count * 3);
                const color1 = new THREE.Color(0x00D4FF); // NordSym Cyan
                const color2 = new THREE.Color(0x9370DB); // NordSym Purple
                const tempColor = new THREE.Color();
                for (let i = 0; i < count; i++) {
                    tempColor.copy(color1).lerp(color2, Math.random());
                    colors[i * 3] = tempColor.r;
                    colors[i * 3 + 1] = tempColor.g;
                    colors[i * 3 + 2] = tempColor.b;
                }
                geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            }

            initGeometry() {
                this.geometries = {
                    tetrahedron: new THREE.TetrahedronGeometry(5, 1), cube: new THREE.BoxGeometry(7, 7, 7),
                    octahedron: new THREE.OctahedronGeometry(5, 1), dodecahedron: new THREE.DodecahedronGeometry(5, 1),
                    icosahedron: new THREE.IcosahedronGeometry(5, 2), seed_of_life: new THREE.SphereGeometry(4.5, 64, 64),
                    flower_of_life: new THREE.TorusGeometry(4, 1.5, 8, 50), metatrons_cube: new THREE.IcosahedronGeometry(5, 1),
                    torus: new THREE.TorusGeometry(4, 1.5, 16, 100), trinity_knot: new THREE.TorusKnotGeometry(3.5, 0.8, 128, 16, 2, 3),
                    diamond_brilliant: new THREE.OctahedronGeometry(5, 0), quartz_point: new THREE.CylinderGeometry(0, 3, 8, 6),
                    bismuth_spiral: new THREE.BoxGeometry(6,6,6), geode: new THREE.SphereGeometry(4.5, 32, 32),
                    prism_triangular: new THREE.CylinderGeometry(4, 4, 6, 3), tesseract: new THREE.BoxGeometry(7, 7, 7),
                    klein_bottle: new THREE.TorusKnotGeometry(3.5, 1, 64, 8, 1, 3), mobius_strip: new THREE.TorusGeometry(4, 0.5, 8, 50),
                    hopf_fibration: new THREE.TorusKnotGeometry(3.5, 0.8, 128, 16, 2, 3), calabi_yau: new THREE.TorusKnotGeometry(3.5, 1.2, 128, 16, 3, 7),
                    fibonacci_spiral: new THREE.TorusGeometry(4, 0.2, 16, 100), galaxy_spiral: new THREE.SphereGeometry(5, 64, 64),
                    merkaba: new THREE.TetrahedronGeometry(5, 0), tetrahedron_grid_64: new THREE.IcosahedronGeometry(5, 2),
                    nebula_cloud: new THREE.SphereGeometry(5, 64, 64), 
                    fractal_fibonacci: this.createFractalGeometry(),
                    fibonacci_sphere: this.createFibonacciSphereGeometry(),
                    galactic_arm: this.createGalacticArmGeometry(),
                    accretion_disk: this.createAccretionDiskGeometry(),
                    cosmic_web: this.createCosmicWebGeometry(),
                    stellated_dodecahedron: this.createStellatedDodecahedronGeometry(),
                    atomic_orbitals: this.createAtomicOrbitalsGeometry(),
                    supernova_remnant: this.createSupernovaRemnantGeometry()
                };
                
                Object.values(this.geometries).forEach(geo => this._addColorAttribute(geo));

                this.geometry = this.geometries.seed_of_life.clone(); this.geometry.computeVertexNormals();
            }
            createFractalGeometry(count = 10000) {
                const points = []; let x = 0.1, y = 0, z = 0; const a = 10, b = 28, c = 8.0 / 3.0; const dt = 0.01;
                for (let i = 0; i < count; i++) { const dx = a * (y - x) * dt; const dy = (x * (b - z) - y) * dt; const dz = (x * y - c * z) * dt; x += dx; y += dy; z += dz; if (i > 100) points.push(x * 0.2, y * 0.2, z * 0.2); }
                const geometry = new THREE.BufferGeometry(); geometry.setAttribute('position', new THREE.Float32BufferAttribute(points, 3)); return geometry;
            }
            createFibonacciSphereGeometry(count = 2000, radius = 5) {
                const points = []; const phi = Math.PI * (3. - Math.sqrt(5.)); 
                for (let i = 0; i < count; i++) { const y = 1 - (i / (count - 1)) * 2; const r = Math.sqrt(1 - y * y); const theta = phi * i; const x = Math.cos(theta) * r; const z = Math.sin(theta) * r; points.push(x * radius, y * radius, z * radius); }
                const geometry = new THREE.BufferGeometry(); geometry.setAttribute('position', new THREE.Float32BufferAttribute(points, 3)); return geometry;
            }
            createGalacticArmGeometry(count = 3000, radius = 6) {
                const points = []; const armCount = 2; const spread = 1.5;
                for (let i = 0; i < count; i++) {
                    const r = Math.sqrt(Math.random()) * radius;
                    const angle = Math.random() * 2 * Math.PI + (r / radius) * 5;
                    const arm = Math.floor(Math.random() * armCount);
                    const armAngle = (2 * Math.PI / armCount) * arm;
                    const x = Math.cos(angle + armAngle) * r + (Math.random() - 0.5) * spread;
                    const y = (Math.random() - 0.5) * (spread / 2) * (1 - r / radius);
                    const z = Math.sin(angle + armAngle) * r + (Math.random() - 0.5) * spread;
                    points.push(x, y, z);
                }
                const geometry = new THREE.BufferGeometry(); geometry.setAttribute('position', new THREE.Float32BufferAttribute(points, 3)); return geometry;
            }
            createAccretionDiskGeometry(count = 15000) {
                const points = [];
                for (let i = 0; i < count; i++) {
                    const r = Math.pow(Math.random(), 2) * 8;
                    const angle = Math.random() * Math.PI * 10;
                    const x = Math.cos(angle) * r;
                    const z = Math.sin(angle) * r;
                    const y = (Math.random() - 0.5) * 0.2 * (1 - r/8);
                    points.push(x, y, z);
                }
                const geometry = new THREE.BufferGeometry(); geometry.setAttribute('position', new THREE.Float32BufferAttribute(points, 3)); return geometry;
            }
            createCosmicWebGeometry(count = 15000) {
                const points = [];
                const nodes = [];
                for(let i = 0; i < 20; i++) { nodes.push(new THREE.Vector3((Math.random() - 0.5) * 30, (Math.random() - 0.5) * 30, (Math.random() - 0.5) * 30)); }
                for (let i = 0; i < count; i++) {
                    const p1 = nodes[Math.floor(Math.random() * nodes.length)];
                    const p2 = nodes[Math.floor(Math.random() * nodes.length)];
                    const point = new THREE.Vector3().lerpVectors(p1, p2, Math.random());
                    point.x += (Math.random() - 0.5) * 0.5;
                    point.y += (Math.random() - 0.5) * 0.5;
                    point.z += (Math.random() - 0.5) * 0.5;
                    points.push(point.x, point.y, point.z);
                }
                const geometry = new THREE.BufferGeometry(); geometry.setAttribute('position', new THREE.Float32BufferAttribute(points, 3)); return geometry;
            }
            createStellatedDodecahedronGeometry() {
                const baseGeo = new THREE.DodecahedronGeometry(5, 0);
                const vertices = [];
                const basePositions = baseGeo.attributes.position;
                for (let i = 0; i < basePositions.count; i += 3) {
                    const v1 = new THREE.Vector3().fromBufferAttribute(basePositions, i);
                    const v2 = new THREE.Vector3().fromBufferAttribute(basePositions, i + 1);
                    const v3 = new THREE.Vector3().fromBufferAttribute(basePositions, i + 2);
                    const center = new THREE.Vector3().add(v1).add(v2).add(v3).divideScalar(3);
                    const stellatedPoint = center.clone().normalize().multiplyScalar(8);
                    vertices.push(v1.x, v1.y, v1.z, v2.x, v2.y, v2.z, stellatedPoint.x, stellatedPoint.y, stellatedPoint.z);
                    vertices.push(v2.x, v2.y, v2.z, v3.x, v3.y, v3.z, stellatedPoint.x, stellatedPoint.y, stellatedPoint.z);
                    vertices.push(v3.x, v3.y, v3.z, v1.x, v1.y, v1.z, stellatedPoint.x, stellatedPoint.y, stellatedPoint.z);
                }
                const geometry = new THREE.BufferGeometry(); geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3)); return geometry;
            }
            createAtomicOrbitalsGeometry(count = 15000) {
                const points = [];
                const radii = [3, 6, 9];
                for (let i = 0; i < count; i++) {
                    const r = radii[Math.floor(Math.random() * radii.length)];
                    const u = Math.random();
                    const v = Math.random();
                    const theta = 2 * Math.PI * u;
                    const phi = Math.acos(2 * v - 1);
                    const x = r * Math.sin(phi) * Math.cos(theta);
                    const y = r * Math.sin(phi) * Math.sin(theta);
                    const z = r * Math.cos(phi);
                    points.push(x, y, z);
                }
                const geometry = new THREE.BufferGeometry(); geometry.setAttribute('position', new THREE.Float32BufferAttribute(points, 3)); return geometry;
            }
            createSupernovaRemnantGeometry(count = 15000) {
                const points = [];
                for (let i = 0; i < count; i++) {
                    const r = 5 + Math.random() * 5;
                    const u = Math.random();
                    const v = Math.random();
                    const theta = 2 * Math.PI * u;
                    const phi = Math.acos(2 * v - 1);
                    const x = r * Math.sin(phi) * Math.cos(theta);
                    const y = r * Math.sin(phi) * Math.sin(theta);
                    const z = r * Math.cos(phi);
                    points.push(x, y, z);
                }
                const geometry = new THREE.BufferGeometry(); geometry.setAttribute('position', new THREE.Float32BufferAttribute(points, 3)); return geometry;
            }
            initMaterials() {
                const nebulaShader = {
                    uniforms: { time: { value: 0 }, opacity: { value: 1.0 }, pointSize: { value: 2.5 }, morphProgress: { value: 0.0 }, pulseIntensity: { value: 1.0 } },
                    vertexShader: `attribute vec3 color; attribute vec3 morphTarget; uniform float time; uniform float pointSize; uniform float morphProgress; varying vec3 vColor; void main() { vColor = color; vec3 p = mix(position, morphTarget, morphProgress); vec4 mvPosition = modelViewMatrix * vec4(p, 1.0); gl_PointSize = pointSize * (20.0 / -mvPosition.z); gl_Position = projectionMatrix * mvPosition; }`,
                    fragmentShader: `uniform float time; uniform float opacity; uniform float pulseIntensity; varying vec3 vColor; void main() { float dist = length(gl_PointCoord - vec2(0.5)); if (dist > 0.45) discard; float pulse = 0.8 + 0.2 * sin(time * 5.0 + vColor.x * 10.0); gl_FragColor = vec4(vColor * pulse * pulseIntensity, smoothstep(0.45, 0.1, dist) * opacity); }`,
                    transparent: true, blending: THREE.AdditiveBlending, depthWrite: false
                };
                this.materials = {
                    neural: new THREE.MeshBasicMaterial({ color: 0x00ffff, wireframe: true, transparent: true, opacity: 0.5 }),
                    organic: new THREE.ShaderMaterial({ uniforms: { time: { value: 0 }, opacity: { value: 1.0 } }, vertexShader: `uniform float time; varying vec3 vNormal; void main() { vNormal = normal; float displacement = sin(position.y * 2.0 + time * 3.0) * 0.2 + cos(position.x * 2.0 + time * 2.0) * 0.2; vec3 newPosition = position + normal * displacement; gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0); }`, fragmentShader: `varying vec3 vNormal; uniform float opacity; void main() { float intensity = pow(0.7 - dot(vNormal, vec3(0.0, 0.0, 1.0)), 2.0); gl_FragColor = vec4(vec3(0.5, 0.8, 1.0) * intensity, opacity); }`, wireframe: true, transparent: true }),
                    crystal: new THREE.ShaderMaterial({ uniforms: { time: { value: 0 }, opacity: { value: 1.0 } }, vertexShader: `varying vec3 vNormal; varying vec3 vViewPosition; void main() { vNormal = normalize(normalMatrix * normal); vec4 mvPosition = modelViewMatrix * vec4(position, 1.0); vViewPosition = -mvPosition.xyz; gl_Position = projectionMatrix * mvPosition; }`, fragmentShader: `varying vec3 vNormal; varying vec3 vViewPosition; uniform float opacity; void main() { vec3 viewDir = normalize(vViewPosition); float fresnel = 1.0 - dot(viewDir, vNormal); fresnel = pow(fresnel, 2.0); vec3 iceColor = vec3(0.9, 0.95, 1.0); vec3 shadowColor = vec3(0.7, 0.85, 1.0); vec3 color = mix(shadowColor, iceColor, fresnel); float frost = sin(vNormal.y * 10.0) * 0.05 + 0.95; gl_FragColor = vec4(color * frost, (0.9 + fresnel * 0.1) * opacity); }`, transparent: true, side: THREE.DoubleSide }),
                    quantum: new THREE.ShaderMaterial({ uniforms: { time: { value: 0 }, opacity: { value: 1.0 } }, vertexShader: `varying vec3 vNormal; varying vec3 vViewPosition; void main() { vNormal = normalize(normalMatrix * normal); vec4 mvPosition = modelViewMatrix * vec4(position, 1.0); vViewPosition = -mvPosition.xyz; gl_Position = projectionMatrix * mvPosition; }`, fragmentShader: `uniform float time; varying vec3 vNormal; varying vec3 vViewPosition; uniform float opacity; void main() { vec3 viewDir = normalize(vViewPosition); float fresnel = 1.0 - dot(viewDir, vNormal); fresnel = pow(fresnel, 4.0); float flicker = 0.8 + sin(vNormal.x * 10.0 + time * 2.0) * 0.2; vec3 baseColor = vec3(0.1, 0.15, 0.3) * flicker; vec3 rimColor = vec3(0.6, 0.8, 1.0); vec3 color = mix(baseColor, rimColor, fresnel); gl_FragColor = vec4(color, (fresnel * 0.5 + 0.3) * opacity); }`, transparent: true, blending: THREE.AdditiveBlending }),
                    nebula: new THREE.ShaderMaterial(nebulaShader)
                };
            }
            initPhysics() { const vertexCount = this.geometry.attributes.position.count; this.originalPositions = new Float32Array(this.geometry.attributes.position.array); this.velocities = new Array(vertexCount).fill(0).map(() => new THREE.Vector3()); }
            initVisuals() { this.mesh = new THREE.Mesh(this.geometry, this.materials.organic); this.mesh.renderOrder = 0; }
            setMaterial(materialKey) {
                const newMat = this.materials[materialKey]; if (!newMat) return;
                const currentOpacity = this.mesh.material.uniforms?.opacity?.value ?? this.mesh.material.opacity;
                if (newMat.uniforms?.opacity) newMat.uniforms.opacity.value = currentOpacity; else newMat.opacity = currentOpacity;
                Object.values(this.materials).forEach(mat => { if(mat.wireframe) mat.wireframe = false; });
                if (newMat.wireframe !== undefined) newMat.wireframe = true;
                const currentScene = this.mesh.parent; if (currentScene) currentScene.remove(this.mesh);
                this.isParticleSystem = (materialKey === 'nebula');
                if (this.isParticleSystem) { if (this.mesh.type !== 'Points') this.mesh = new THREE.Points(this.mesh.geometry, newMat); } else { if (this.mesh.type !== 'Mesh') this.mesh = new THREE.Mesh(this.mesh.geometry, newMat); }
                this.mesh.material = newMat; if (currentScene) currentScene.add(this.mesh);
            }
            update(time) {
                if (this.mesh.material.uniforms && this.mesh.material.uniforms.time) { this.mesh.material.uniforms.time.value = time; }
                if (this.isParticleSystem) return;
                const positions = this.geometry.attributes.position.array; const restPos = new THREE.Vector3(); const currentPos = new THREE.Vector3();
                for (let i = 0; i < this.velocities.length; i++) {
                    restPos.fromArray(this.originalPositions, i * 3); currentPos.fromArray(positions, i * 3);
                    if (this.velocities[i].lengthSq() < this.velocityThreshold * this.velocityThreshold && currentPos.distanceToSquared(restPos) < 0.001) { this.velocities[i].set(0, 0, 0); currentPos.copy(restPos); } else { const springForce = restPos.clone().sub(currentPos).multiplyScalar(this.SPRING_STRENGTH); this.velocities[i].add(springForce); this.velocities[i].multiplyScalar(this.DAMPING); currentPos.add(this.velocities[i]); }
                    currentPos.toArray(positions, i * 3);
                }
                this.geometry.attributes.position.needsUpdate = true; this.geometry.computeVertexNormals();
            }
            nudge() { 
                if (this.isParticleSystem) { 
                    gsap.to(this.mesh.material.uniforms.pulseIntensity, { value: 2.5, duration: 0.3, yoyo: true, repeat: 1, ease: 'power2.inOut' });
                } else {
                    for (let i = 0; i < this.velocities.length; i++) { this.velocities[i].add(new THREE.Vector3(Math.random()-0.5, Math.random()-0.5, Math.random()-0.5).multiplyScalar(0.1)); }
                }
            }
            morphToShape(shapeKey, scale = 1.0) {
                const targetGeo = this.geometries[shapeKey.toLowerCase()]; if (!targetGeo || !targetGeo.attributes.position) return; if (this.activeMorph) this.activeMorph.kill();
                const targetPositions = new Float32Array(this.originalPositions.length); const vertexCount = this.originalPositions.length / 3;
                for (let i = 0; i < vertexCount; i++) { const targetIndex = i % targetGeo.attributes.position.count; targetPositions[i*3] = targetGeo.attributes.position.array[targetIndex*3] * scale; targetPositions[i*3+1] = targetGeo.attributes.position.array[targetIndex*3+1] * scale; targetPositions[i*3+2] = targetGeo.attributes.position.array[targetIndex*3+2] * scale; }
                if (this.isParticleSystem) { 
                    this.geometry.setAttribute('position', new THREE.BufferAttribute(targetPositions, 3)); 
                    this.geometry.setAttribute('color', targetGeo.attributes.color.clone());
                    this.geometry.attributes.position.needsUpdate = true; 
                    this.geometry.attributes.color.needsUpdate = true;
                } else { this.activeMorph = gsap.to(this.originalPositions, { endArray: targetPositions, duration: 2.0, ease: "power3.inOut" }); }
            }
            setMorph(fromKey, toKey, progress) {
                const fromGeo = this.geometries[fromKey.toLowerCase()]; const toGeo = this.geometries[toKey.toLowerCase()]; if (!fromGeo || !toGeo) return;
                const fromPos = fromGeo.attributes.position.array; const toPos = toGeo.attributes.position.array; const vertexCount = this.originalPositions.length / 3;
                if (this.isParticleSystem) {
                    if (!this.geometry.attributes.morphTarget) { this.geometry.setAttribute('morphTarget', new THREE.BufferAttribute(new Float32Array(vertexCount * 3), 3)); }
                    if (!this.geometry.attributes.color) { this.geometry.setAttribute('color', new THREE.BufferAttribute(new Float32Array(vertexCount * 3), 3)); }
                    const startArray = this.geometry.attributes.position.array; const targetArray = this.geometry.attributes.morphTarget.array;
                    const colorArray = this.geometry.attributes.color.array;
                    const fromColors = fromGeo.attributes.color.array;
                    for (let i = 0; i < vertexCount; i++) {
                        const fromIndex = (i % fromGeo.attributes.position.count) * 3; const toIndex = (i % toGeo.attributes.position.count) * 3;
                        startArray[i*3] = fromPos[fromIndex]; startArray[i*3+1] = fromPos[fromIndex+1]; startArray[i*3+2] = fromPos[fromIndex+2];
                        targetArray[i*3] = toPos[toIndex]; targetArray[i*3+1] = toPos[toIndex+1]; targetArray[i*3+2] = toPos[toIndex+2];
                        const fromColorIndex = (i % fromGeo.attributes.color.count) * 3;
                        colorArray[i*3] = fromColors[fromColorIndex];
                        colorArray[i*3+1] = fromColors[fromColorIndex+1];
                        colorArray[i*3+2] = fromColors[fromColorIndex+2];
                    }
                    this.geometry.attributes.position.needsUpdate = true; this.geometry.attributes.morphTarget.needsUpdate = true;
                    this.geometry.attributes.color.needsUpdate = true;
                    this.mesh.material.uniforms.morphProgress.value = progress;
                } else {
                    for (let i = 0; i < vertexCount; i++) {
                        const fromIndex = (i % fromGeo.attributes.position.count) * 3; const toIndex = (i % toGeo.attributes.position.count) * 3;
                        const x = fromPos[fromIndex] * (1 - progress) + toPos[toIndex] * progress;
                        const y = fromPos[fromIndex + 1] * (1 - progress) + toPos[toIndex + 1] * progress;
                        const z = fromPos[fromIndex + 2] * (1 - progress) + toPos[toIndex + 2] * progress;
                        this.originalPositions[i * 3] = x; this.originalPositions[i * 3 + 1] = y; this.originalPositions[i * 3 + 2] = z;
                    }
                }
            }
        }
        
        // Anti-Fragile Initialization Sequence
        try {
            window.UnifiedGeometryManager = new UnifiedGeometryManager();
            window.UnifiedGeometryManager.init();

            if (!window.UnifiedGeometryManager.initializationFailed) {
                new RitbordetManager().init();
                new GalleryManager().init();
            } else {
                throw new Error("Kritisk visuell komponent (UnifiedGeometryManager) misslyckades att initiera. Faller tillbaka till grundläggande funktionalitet.");
            }
        } catch (error) {
            console.error("Total systemharmoni kunde inte uppnås:", error);
            logToExternalService(error, "GlobalInitialization");
        }

        window.nord.closeMobileMenu = () => {
             const mobileMenu = document.getElementById('mobile-menu');
             const mobileMenuTrigger = document.getElementById('mobile-menu-trigger');
             if(mobileMenu && mobileMenuTrigger) {
                mobileMenu.classList.remove('open');
                mobileMenuTrigger.classList.remove('active');
             }
        };
        window.nord.updateActiveLink = function(navId) {
            document.querySelectorAll('header nav a.nav-link, #mobile-menu a').forEach(link => {
                link.classList.remove('active');
                if (link.closest('#mobile-menu')) { link.classList.remove('bg-sky-700/50', 'nord-accent-text', 'font-semibold'); }
            });
            const activeLinks = document.querySelectorAll(`a[data-nav="${navId}"]`);
            activeLinks.forEach(link => {
                link.classList.add('active');
                if (link.closest('#mobile-menu')) { link.classList.add('bg-sky-700/50', 'nord-accent-text', 'font-semibold'); }
            });
        };
        
        const mobileMenuTrigger = document.getElementById('mobile-menu-trigger');
        if (mobileMenuTrigger) {
            mobileMenuTrigger.addEventListener('click', () => {
                const mobileMenu = document.getElementById('mobile-menu');
                mobileMenu.classList.toggle('open');
                mobileMenuTrigger.classList.toggle('active');
            });
        }
        
        function setupCTAInteractions() {
            const ctaSelectors = [ '.btn-cta-revised', '.btn-secondary-on-dark', '.venn-overlap-text', '#hero-logo-wrapper', '.nav-link' ];
            const interactiveElements = document.querySelectorAll(ctaSelectors.join(', '));
            interactiveElements.forEach(el => {
                const nudgeEffect = () => {
                    if (window.UnifiedGeometryManager && window.UnifiedGeometryManager.elasticGeometry && !document.body.classList.contains('labb-active')) {
                        window.UnifiedGeometryManager.elasticGeometry.nudge();
                    }
                };
                el.addEventListener('mouseenter', nudgeEffect);
                el.addEventListener('click', nudgeEffect);
            });
        }

        window.addEventListener('load', () => { const hash = window.location.hash.substring(1); window.nord.showPage(pageConfig[hash] ? hash : 'hero'); });
        
        new FormManager('formSkraddarsydd', 'xqabggao');
        new FormManager('jobApplicationForm', 'xblypplz');

        setupCTAInteractions();
        document.getElementById('currentYear').textContent = new Date().getFullYear();
    });

    class RitbordetManager {
        constructor() {
            this.processCardsData = [
                { icon: 'ph-map-trifold', title: 'KARTLÄGGNING', description: 'Vi avkodar era värdeflöden och identifierar möjligheter för intelligent förstärkning.' },
                { icon: 'ph-compass-tool', title: 'ARKITEKTUR', description: 'Vi designar intelligenta system kalibrerade för era unika processer och affärslogik.' },
                { icon: 'ph-rocket-launch', title: 'AKTIVERING', description: 'Systemet integreras. Era processer förvandlas till lärande intelligens.' }
            ];
            this.valueCardsData = [
                 { type: 'default', icon: 'ph-graph', title: 'TRANSFORMATION', description: 'Intelligenta system som växer med er verksamhet och möjliggör obegränsad skalning.', buttonText: 'Läs Caset →', page: 'atom-gallery-section' },
                 { type: 'default', icon: 'ph-atom', title: 'KÄRNKOMPONENTER', description: 'Distribuerad intelligens byggd på era affärsregler - system som förstår er branschlogik och utvecklas med den.', buttonText: 'Utforska Arkitekturen', page: 'system', tooltip: 'Vår motor för sömlös synkronisering av intelligens.' },
                 { type: 'pricing-preview', title: 'INVESTERING', price: '75k - 500k+', description: 'Från investering till intelligent evolution. Er framtidsförsäkring börjar här.', buttonText: 'Se Paket →', page: 'system' }
            ];
        }

        init() {
            this.populateDesktopCards();
            this.initLayoutManager();
        }

        populateDesktopCards() {
            const processContainer = document.getElementById('ritbordet-grid-process');
            const valueContainer = document.getElementById('ritbordet-grid-value');
            if(!processContainer || !valueContainer) return;
            
            processContainer.innerHTML = this.processCardsData.map(card => this.createCardHTML(card)).join('');
            valueContainer.innerHTML = this.valueCardsData.map(card => this.createCardHTML(card)).join('');
        }
        
        createCardHTML(card) {
            const clickHandler = `window.nord.showPage('hero'); setTimeout(() => document.getElementById('${card.page}').scrollIntoView({ behavior: 'smooth' }), 500);`;
            if(card.type === 'success-story') {
                return `<div class="ritbordet-card success-story card-base">
                            <span class="metric">${card.metric}</span>
                            <h4>${card.title}</h4>
                            <p>${card.description}</p>
                            <button onclick="${clickHandler}" class="btn-base btn-secondary-on-dark text-sm">${card.buttonText}</button>
                        </div>`;
            }
            if(card.type === 'pricing-preview') {
                return `<div class="ritbordet-card pricing-preview card-base">
                            <i class="ph ph-tag"></i>
                            <h4>${card.title}</h4>
                            <div class="price-range">${card.price}</div>
                            <p>${card.description}</p>
                            <button onclick="window.nord.showPage('${card.page}')" class="btn-base btn-secondary-on-dark text-sm">${card.buttonText}</button>
                        </div>`;
            }
             if(card.icon) {
                return `<div class="ritbordet-card card-base" ${card.tooltip ? `title="${card.tooltip}"` : ''}>
                            <i class="ph ${card.icon}"></i>
                            <h4>${card.title}</h4>
                            <p>${card.description}</p>
                            ${card.buttonText ? `<button onclick="${card.page === 'atom-gallery-section' ? clickHandler : `window.nord.showPage('${card.page}')`}" class="btn-base btn-secondary-on-dark text-sm">${card.buttonText}</button>` : ''}
                        </div>`;
            }
            return '';
        }

        initLayoutManager() {
            this.updateLayout();
            window.addEventListener('resize', () => this.updateLayout());
        }

        updateLayout() {
            const isMobile = window.innerWidth < 768;
            if (isMobile && !this.mobileLayoutInitialized) {
                this.renderMobileLayout();
                this.mobileLayoutInitialized = true;
                this.desktopLayoutInitialized = false;
            } else if (!isMobile && !this.desktopLayoutInitialized) {
                this.renderDesktopLayout();
                this.desktopLayoutInitialized = true;
                this.mobileLayoutInitialized = false;
            }
        }
        
        renderDesktopLayout() {
            const mobileContent = document.getElementById('mobile-lobby-content');
            if (mobileContent) mobileContent.innerHTML = '';
        }

        renderMobileLayout() {
            const mobileContent = document.getElementById('mobile-lobby-content');
            if (!mobileContent || mobileContent.innerHTML !== '') return;

            const processHTML = `<h3>Process</h3><div class="ritbordet-grid">${this.processCardsData.map(c => this.createCardHTML(c)).join('')}</div>`;
            const valueHTML = `<h3>Värde</h3><div class="ritbordet-grid">${this.valueCardsData.map(c => this.createCardHTML(c)).join('')}</div>`;
            
            mobileContent.innerHTML = processHTML + valueHTML;
        }
    }

    class GalleryManager {
        constructor() {
            this.isInitialMobileLoad = true; // HARMONI-FIX: Flagga för att förhindra initial scroll.
            this.galleryData = [
                {
                    status: 'active',
                    sidebar: { industry: 'Event & Catering', tech: 'React, n8n, Airtable, Gemini', status: 'I Drift' },
                    main: { title: 'AI-driven Event & Catering Portal', description: 'För en ledande cateringaktör eliminerade vi manuell offerthantering. Vårt system fungerar som en digital eventkoordinator - från första kundkontakt till färdig offert, inklusive menyrådgivning och planering, så att teamet kan fokusera på att leverera fantastiska upplevelser.' },
                    results: [ { icon: 'ph-clock-arrow-counter-clockwise', value: '>75%', label: 'Minskad Admin'}, { icon: 'ph-chat-centered-text', value: '+40%', label: 'Kundinteraktion'}, { icon: 'ph-sparkle', value: 'Förhöjd', label: 'Kundupplevelse'} ]
                },
                {
                    status: 'active',
                    sidebar: { industry: 'Sälj / Alla B2B', tech: 'CRM Integration, n8n, LLM', status: 'Tillgänglig' },
                    main: { title: '24/7 AI Säljassistent', description: 'En outtröttlig säljassistent som arbetar dygnet runt. Den fångar upp leads, utför research och skickar personaliserade uppföljningar för att hålla er säljpipeline fylld och era säljare fokuserade på avslut.' },
                    results: [ { icon: 'ph-chart-bar', value: '+25%', label: 'Konverteringsgrad'}, { icon: 'ph-power', value: '24/7', label: 'Alltid Aktiv'}, { icon: 'ph-chat-centered-dots', value: '100%', label: 'Personaliserad Dialog'} ]
                },
                {
                    status: 'active',
                    sidebar: { industry: 'Alla', tech: 'Multi-LLM, n8n, API', status: 'Tillgänglig' },
                    main: { title: 'Intern Synk-Nod', description: 'Hjärtat i våra ekosystem. En egenutvecklad motor som sömlöst synkroniserar data och intelligens mellan olika AI-plattformar (Claude, Gemini, etc.) och era befintliga system. <a href="URL_TILL_DIN_DEMO.html" target="_blank" rel="noopener noreferrer" class="text-nord-sym-cyan hover:underline font-semibold">Utforska en interaktiv demo här.</a>' },
                    results: [ { icon: 'ph-arrows-clockwise', value: 'Sömlös', label: 'Synkronisering'}, { icon: 'ph-plugs-connected', value: 'Universell', label: 'Integration'}, { icon: 'ph-brain', value: 'Kollektiv', label: 'Intelligens'} ]
                },
                {
                    status: 'active',
                    sidebar: { industry: 'Konsult / Strategi / Finans', tech: 'LangGraph, n8n, Multi-LLM', status: 'Tillgänglig' },
                    main: { title: 'Multi-Agent Research System', description: 'Ett avancerat system där specialiserade AI-agenter samarbetar för att genomföra djupgående marknads-, företags- och konkurrentanalys på en bråkdel av tiden.' },
                    results: [ { icon: 'ph-timer', value: '>95%', label: 'Snabbare Analys'}, { icon: 'ph-brain', value: 'Djupare', label: 'Insikter'}, { icon: 'ph-chart-line-up', value: 'Skalbar', label: 'Research On-Demand'} ]
                },
                {
                    status: 'frosted-heavy',
                    sidebar: { industry: 'E-handel', tech: 'AI, Machine Learning', status: 'Under Utveckling' },
                    main: { title: 'Dynamisk Prisoptimering', description: 'Ett självlärande system som analyserar marknadstrender, konkurrenters prissättning och interna data för att automatiskt justera priser i realtid för maximal lönsamhet.' },
                    results: [ { icon: 'ph-currency-dollar', value: 'Ökad', label: 'Maringal'}, { icon: 'ph-chart-line', value: 'Optimerad', label: 'Konvertering'}, { icon: 'ph-robot', value: 'Fullt', label: 'Autonom'} ]
                },
                {
                    status: 'frosted-heavy',
                    sidebar: { industry: 'Logistik', tech: 'AI, IoT, API', status: 'Under Utveckling' },
                    main: { title: 'Prediktiv Logistikkedja', description: 'Ett system som förutser flaskhalsar och störningar i er logistikkedja innan de inträffar, och proaktivt föreslår och implementerar optimerade rutter och lagerhantering.' },
                    results: [ { icon: 'ph-truck', value: 'Minskade', label: 'Ledtider'}, { icon: 'ph-package', value: 'Optimerat', label: 'Lager'}, { icon: 'ph-shield-check', value: 'Högre', label: 'Leveranssäkerhet'} ]
                }
            ];
        }
        init() {
            this.populateGallery();
            this.setupGalleryControls();
        }
        populateGallery() {
            const wrapper = document.getElementById('galleryWrapper');
            if (!wrapper) return;
            wrapper.innerHTML = this.galleryData.map(cardData => this.createCardHTML(cardData)).join('');
        }
        createCardHTML(data) {
            const frostedClass = data.status.startsWith('frosted') ? data.status : '';
            return `
                <div class="case-study-card card-base ${frostedClass}">
                    <div class="case-study-sidebar">
                        <div class="case-study-sidebar-item"><i class="ph-buildings"></i><div><h5>Bransch</h5><p>${data.sidebar.industry}</p></div></div>
                        <div class="case-study-sidebar-item"><i class="ph-compass-tool"></i><div><h5>Teknik</h5><p>${data.sidebar.tech}</p></div></div>
                        <div class="case-study-sidebar-item"><i class="ph-power"></i><div><h5>Status</h5><p>${data.sidebar.status}</p></div></div>
                    </div>
                    <div class="case-study-main">
                        <h4>${data.main.title}</h4>
                        <p>${data.main.description}</p>
                        <div class="case-study-results-grid">
                            ${data.results.map(r => `<div class="case-study-result-item"><i class="ph ${r.icon}"></i><div class="value">${r.value}</div><div class="label">${r.label}</div></div>`).join('')}
                        </div>
                    </div>
                </div>
            `;
        }
        setupGalleryControls() {
            const galleryWrapper = document.getElementById('galleryWrapper'), nextBtn = document.getElementById('galleryNext'), prevBtn = document.getElementById('galleryPrev');
            if (!galleryWrapper || !nextBtn || !prevBtn) return;
            let currentIndex = 0;
            const totalCards = this.galleryData.length;
            const updateGallery = () => {
                if (window.innerWidth > 768) {
                    galleryWrapper.style.transform = `translateX(-${currentIndex * 100}%)`;
                } else {
                    // HARMONI-FIX: Kör bara scrollIntoView om det inte är den första laddningen.
                    if (!this.isInitialMobileLoad) {
                        const card = galleryWrapper.children[currentIndex];
                        if(card) card.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });
                    }
                    // Vänd flaggan efter den första körningen.
                    this.isInitialMobileLoad = false;
                }
                prevBtn.classList.toggle('disabled', currentIndex === 0);
                nextBtn.classList.toggle('disabled', currentIndex === totalCards - 1);
            };
            nextBtn.addEventListener('click', () => { if (currentIndex < totalCards - 1) { currentIndex++; updateGallery(); } });
            prevBtn.addEventListener('click', () => { if (currentIndex > 0) { currentIndex--; updateGallery(); } });
            window.addEventListener('resize', updateGallery);
            updateGallery();
        }
    }

    class FormManager {
        constructor(formId, formspreeId) {
            this.formId = formId;
            this.formspreeId = formspreeId;
            this.formElement = document.getElementById(this.formId);
            if (!this.formElement) return;

            this.container = this.formElement.closest('.form-container');
            this.steps = this.formElement.querySelectorAll('.form-step');
            this.progressBar = this.container.querySelector('.form-progress-bar-inner');
            this.currentStep = 0;
            this.totalSteps = this.steps.length;

            this.init();
        }

        init() {
            this.setupEventListeners();
            this.updateProgress();
            this.steps[0].classList.add('active');
        }

        setupEventListeners() {
            this.formElement.addEventListener('submit', this.handleSubmit.bind(this));
            
            this.formElement.querySelectorAll('.form-navigation button').forEach(button => {
                button.addEventListener('click', (e) => {
                    if (e.currentTarget.type === 'button') {
                        const isNext = e.currentTarget.textContent.includes('Nästa');
                        if (isNext) this.nextStep();
                        else this.prevStep();
                    }
                });
            });
        }

        changeStep(stepIndex) {
            const currentStepElement = this.steps[this.currentStep];
            const nextStepElement = this.steps[stepIndex];

            gsap.to(currentStepElement, {
                opacity: 0, 
                y: -10, 
                duration: 0.3, 
                ease: 'power2.in', 
                onComplete: () => {
                    currentStepElement.classList.remove('active');
                    nextStepElement.classList.add('active');
                    this.currentStep = stepIndex;
                    this.updateProgress();
                    gsap.fromTo(nextStepElement, 
                        { opacity: 0, y: 10 }, 
                        { opacity: 1, y: 0, duration: 0.3, ease: 'power2.out' }
                    );
                }
            });
        }

        validateStep() {
            const currentStepElement = this.steps[this.currentStep];
            const inputs = currentStepElement.querySelectorAll('input[required], textarea[required]');
            for (const input of inputs) {
                if (!input.value.trim()) {
                    input.focus();
                    gsap.fromTo(input, { x: -5 }, { x: 5, duration: 0.05, repeat: 5, yoyo: true, clearProps: 'x' });
                    return false;
                }
            }
            return true;
        }

        nextStep() {
            if (this.validateStep() && this.currentStep < this.totalSteps - 1) {
                this.changeStep(this.currentStep + 1);
            }
        }

        prevStep() {
            if (this.currentStep > 0) {
                this.changeStep(this.currentStep + 1);
            }
        }

        updateProgress() {
            const progress = ((this.currentStep + 1) / this.totalSteps) * 100;
            if (this.progressBar) {
                this.progressBar.style.width = `${progress}%`;
            }
        }

        handleSubmit(e) {
            e.preventDefault();
            if (!this.validateStep()) return;

            this.container.classList.add('form-loading');
            
            fetch(`https://formspree.io/f/${this.formspreeId}`, {
                method: 'POST',
                body: new FormData(this.formElement),
                headers: { 'Accept': 'application/json' }
            }).then(response => {
                this.container.classList.remove('form-loading');
                if (response.ok) {
                    this.showSuccess();
                } else {
                    throw new Error('Form submission failed');
                }
            }).catch(() => {
                this.container.classList.remove('form-loading');
                this.showError();
            });
        }

        showSuccess() {
            const successHTML = `
                <div class="form-success-container">
                    <i class="ph-star-four nordsym-logo-star"></i>
                    <p>Tack! Ditt meddelande har skickats. Vi återkommer snart.</p>
                </div>`;
            
            gsap.to(this.container.children, {
                opacity: 0,
                duration: 0.5,
                ease: 'power2.in',
                onComplete: () => {
                    this.container.innerHTML = successHTML;
                    gsap.fromTo(this.container.children, 
                        { opacity: 0, scale: 0.9 },
                        { opacity: 1, scale: 1, duration: 0.5, ease: 'power2.out' }
                    );
                }
            });
        }

        showError() {
            const errorHTML = `<div class="form-message form-error-message" style="display:block;">Ett fel uppstod. Försök igen eller kontakta oss direkt.</div>`;
            this.formElement.innerHTML = errorHTML;
        }
    }
    </script>
</body>
</html>
